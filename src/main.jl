using Base.Threads
using Random
using DelimitedFiles
using Distributions
using DataFrames
using CSV
using JLD

include("global/variables.jl")

include("model/virus.jl")
include("model/agent.jl")
include("model/group.jl")
include("model/household.jl")
include("model/workplace.jl")
include("model/school.jl")
include("model/public_space.jl")
include("model/initialization.jl")
include("model/simulation.jl")
include("model/connections.jl")

include("data/district_households.jl")
include("data/district_people.jl")
include("data/district_people_households.jl")
include("data/district_nums.jl")
include("data/temperature.jl")
include("data/etiology.jl")

include("util/moving_avg.jl")
include("util/stats.jl")
include("util/reset.jl")

function main()
    println("Initialization...")

    # Random seed number
    run_num = 0
    is_rt_run = true
    try
        run_num = parse(Int64, ARGS[1])
    catch
        run_num = 0
    end

    num_years = 2
    # num_years = 1

    # !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
    # CHANGE
    school_class_closure_period = 0
    # school_class_closure_period = 7
    school_class_closure_threshold = 0.2
    # school_class_closure_threshold = 1.0

    with_global_warming = false
    # with_global_warming = true
    # !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

    num_threads = nthreads()

    # Вероятности изолироваться при болезни на 1-й, 2-й и 3-й дни
    isolation_probabilities_day_1 = [0.406, 0.305, 0.204, 0.101]
    isolation_probabilities_day_2 = [0.669, 0.576, 0.499, 0.334]
    isolation_probabilities_day_3 = [0.45, 0.325, 0.376, 0.168]
    # Продолжительность резистентного состояния
    recovered_duration_mean = 6.0
    recovered_duration_sd = 2.0
    # Продолжительности контактов в домохозяйствах
    # Укороченные для различных коллективов и полная: Kinder, School, College, Work, Full
    mean_household_contact_durations = [6.5, 5.8, 9.0, 4.5, 12.0]
    household_contact_duration_sds = [2.2, 2.0, 3.0, 1.5, 4.0]
    # Продолжительности контактов в прочих коллективах
    other_contact_duration_shapes = [2.5, 1.78, 2.0, 1.81, 1.2]
    other_contact_duration_scales = [1.6, 1.95, 1.07, 1.7, 1.07]
    # Параметры, отвечающие за связи на рабочих местах
    firm_min_size = 1
    firm_max_size = 1000
    # num_barabasi_albert_attachments = 6
    num_barabasi_albert_attachments = 5
    # num_barabasi_albert_attachments = 4

    # !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
    # duration_parameter = 3.2773964131106976
    # susceptibility_parameters = [3.1125850340136045, 3.376571840857553, 3.5534219748505502, 5.038146773861062, 3.9956957328385956, 3.9007689136260537, 4.6524469181612]
    # temperature_parameters = [-0.729115646258503, -0.945928674500103, -0.19397979797979797, -0.12122626262626261, -0.13760977118119966, -0.16354195011337874, -0.20555555555555546]
    # random_infection_probabilities = [0.00011640445269016696, 6.788884766027622e-5, 4.9130447330447355e-5, 6.997670583384872e-7]
    # mean_immunity_durations = [254.75613275613273, 298.2230467944754, 106.60214388785818, 43.368377654091915, 90.5388579674294, 119.93980622552051, 117.15357658214805]
    # immune_memory_susceptibility_levels = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
    # immune_memory_susceptibility_levels = [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]

    # MAE = 8663.269001831502
    # RMSE = 18628.12087132402
    # nMAE = 0.8524129372677983
    # nMAE_general = 0.2403411364977252
    # nMAE_0_2 = 0.6494755262709271
    # nMAE_3_6 = 0.396511351331857
    # nMAE_7_14 = 0.3273033886853395
    # nMAE_15 = 0.31583202004805333
    # nMAE_FluA = 0.5960861433037131
    # nMAE_FluB = 0.5045083619825148
    # nMAE_RV = 0.4543247425811245
    # nMAE_RSV = 0.34443620960421767
    # nMAE_AdV = 0.4120379241126699
    # nMAE_PIV = 0.4534597210854482
    # nMAE_CoV = 0.49009863399381226
    # averaged_nMAE = 0.43203459662478355
    # S_square = 1.515726083275e12
    # duration_parameter = 3.4981229101810194
    # susceptibility_parameters = [2.991060937985877, 3.2468795530538848, 3.401898437854858, 4.649676110814129, 3.7163523159649126, 3.8596161196887557, 4.856247287821134]
    # temperature_parameters = [-0.9306122448979591, -0.9078000691802144, -0.01428571428571429, -0.12176102079249784, -0.16673883420856778, -0.19917639906501897, -0.33896680397891044]
    # random_infection_probabilities = [0.0014812661428353913, 0.0008664926507337254, 0.0003871328065857679, 9.304102575238382e-6]
    # immune_memory_susceptibility_levels = [0.8659281154680671, 0.9648299319727879, 0.9616326530612245, 0.9726530612244898, 0.9628571428571429, 0.9738775510204082, 0.8885714285714285]
    # mean_immunity_durations = [336.32831252685975, 308.6526629141642, 132.1112562498035, 92.83376833013635, 100.85806526000232, 141.48287440297122, 160.4937231184206]





    # 4.9579158316633265
    # [2.2064128256513027, 7.9579158316633265, 1.561122244488978, 3.3286573146292584, 7.5230460921843685, 2.6693386773547094, 3.1042084168336674]
    # [-0.8472344689378757, -0.8016032064128257, -0.37505010020040075, -0.3552104208416834, -0.5297995991983968, -0.2818036072144289, -0.7718436873747495]       
    # [0.8176352705410821, 0.5450901803607214, 0.6723446893787575, 0.7394789579158316, 0.530060120240481, 0.9809619238476954, 0.5050100200400801]
    # [168.52705410821645, 127.85370741482966, 124.40681362725451, 309.8496993987976, 287.1002004008016, 305.02404809619236, 214.02605210420842]
    # [0.0012925851703406814, 0.0009869739478957915, 0.0004819639278557115, 6.683366733466934e-6]

    # !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
    # Surrogate model training

    # 1
    # duration_parameter = 4.847949316438813
    # susceptibility_parameters = [4.669223074358119, 7.85995331777259, 1.5858619539846615, 4.0250083361120375, 1.0093364454818272, 1.7282427475825275, 6.032344114704902]
    # temperature_parameters = [-0.5589729909969989, -0.1707635878626208, -0.02386462154051361, -0.9699599866622207, -0.19717239079693238, -0.42395798599533174, -0.8379159719906636]
    # immune_memory_susceptibility_levels = [0.5505168389463154, 0.8561187062354119, 0.5735245081693898, 0.5993664554851618, 0.5781927309103034, 0.8844614871623875, 0.6083694564854951]
    # mean_immunity_durations = [250.98332777592532, 30.291097032344116, 78.00833611203734, 234.351117039013, 117.35211737245749, 219.8982994331444, 353.75891963987993]
    # random_infection_probabilities = [0.001551517172390797, 0.0007880960320106702, 0.00024671557185728575, 8.987995998666223e-6]

    # 2
    # duration_parameter = 4.755918639546516
    # susceptibility_parameters = [3.271090363454485, 7.964988329443147, 4.015671890630211, 5.630876958986328, 7.470156718906302, 2.9209736578859617, 3.798599533177726]
    # temperature_parameters = [-0.8441880626875625, -0.73162054018006, -0.46918306102034013, -0.7748649549849951, -0.9653384461487162, -0.6444714904968323, -0.01726242080693563]
    # immune_memory_susceptibility_levels = [0.5428476158719573, 0.7007335778592865, 0.9374791597199066, 0.6407135711903968, 0.9868289429809937, 0.9754918306102034, 0.7467489163054352]
    # mean_immunity_durations = [340.1090363454485, 34.07635878626209, 156.58119373124376, 321.52684228076026, 301.56818939646547, 45.546848949649885, 223.22474158052685]
    # random_infection_probabilities = [0.0013334444814938314, 0.000626542180726909, 0.0004810936978992998, 1.3296098699566521e-5]

    # 3
    # duration_parameter = 4.816938979659886
    # susceptibility_parameters = [2.7435811937312438, 7.985995331777259, 5.056685561853952, 6.711570523507836, 1.2217405801933978, 6.3591197065688565, 4.608536178726242]
    # temperature_parameters = [-0.7062020673557853, -0.04763254418139373, -0.9468522840946982, -0.04763254418139373, -0.6441413804601535, -0.4186762254084695, -0.7659519839946649]
    # immune_memory_susceptibility_levels = [0.7277425808602868, 0.9956652217405801, 0.5020006668889629, 0.9493164388129376, 0.9066355451817272, 0.6833944648216073, 0.8702900966988996]
    # mean_immunity_durations = [150.5018339446482, 299.15938646215403, 220.70123374458151, 339.65021673891295, 293.6535511837279, 108.29043014338113, 288.83594531510505]
    # random_infection_probabilities = [0.0017635878626208737, 0.000697732577525842, 0.00037845948649549855, 1.456318772924308e-5]

    # 4
    # duration_parameter = 4.988996332110704
    # susceptibility_parameters = [7.610203401133711, 6.975325108369456, 4.47082360786929, 5.95998666222074, 3.8942980993664555, 7.1760586862287425, 6.828276092030677]
    # temperature_parameters = [-0.25956318772924303, -0.17241413804601535, -0.8207502500833611, -0.8062254084694899, -0.9438812937645882, -0.7940113371123708, -0.7600100033344448]
    # immune_memory_susceptibility_levels = [0.7889296432144048, 0.646215405135045, 0.5563521173724575, 0.9594864954984995, 0.9773257752584195, 0.5855285095031677, 0.9161387129043015]
    # mean_immunity_durations = [179.52217405801935, 120.33444481493831, 112.30510170056685, 364.5411803934645, 149.69889963321108, 263.83027675891964, 68.14371457152384]
    # random_infection_probabilities = [0.0016138712904301433, 0.0007345781927309103, 0.0002571190396798933, 1.1428809603201067e-5]
    
    # 5
    # duration_parameter = 4.866955651883961
    # susceptibility_parameters = [7.619539846615538, 6.779259753251083, 4.1183727909303105, 3.9036345448482828, 7.894964988329443, 6.718572857619207, 7.649883294431477]
    # temperature_parameters = [-0.8758786262087362, -0.6712104034678226, -0.2872924308102701, -0.33449816605535176, -0.14798599533177725, -0.22160053351117037, -0.3569456485495165]
    # immune_memory_susceptibility_levels = [0.5110036678892964, 0.9511503834611537, 0.6872290763587863, 0.7900966988996332, 0.984161387129043, 0.8606202067355786, 0.5655218406135378]
    # mean_immunity_durations = [28.111703901300434, 236.07169056352117, 251.44214738246083, 307.99166388796266, 224.37179059686562, 224.02767589196398, 96.36112037345782]
    # random_infection_probabilities = [0.001918972990996999, 0.0005760253417805936, 0.00035855285095031677, 6.537179059686563e-6]

    # 6
    # duration_parameter = 4.916972324108036
    # susceptibility_parameters = [5.364788262754251, 4.606202067355785, 4.8816272090696895, 5.320440146715572, 6.002000666888963, 1.0490163387795932, 4.0926975658552855]
    # temperature_parameters = [-0.9062487495831943, -0.13511170390130034, -0.4526775591863954, -0.3602467489163055, -0.3140313437812605, -0.17373457819273097, -0.9313371123707903]
    # immune_memory_susceptibility_levels = [0.9034678226075359, 0.8704568189396465, 0.6408802934311437, 0.5143381127042348, 0.5295098366122041, 0.7639213071023674, 0.6620540180060019]
    # mean_immunity_durations = [130.3137712570857, 251.78626208736245, 335.2914304768256, 139.60486828942982, 56.09969989996666, 151.41947315771924, 114.48449483161053]
    # random_infection_probabilities = [0.0016748916305435145, 0.0009021340446815605, 0.00021720573524508171, 9.121373791263756e-6]

    # 7
    # duration_parameter = 4.627875958652885
    # susceptibility_parameters = [3.394798266088696, 6.863287762587529, 2.5148382794264754, 6.3591197065688565, 3.5698566188729575, 3.9946648882960987, 7.057019006335445]
    # temperature_parameters = [-0.22325108369456492, -0.8214104701567189, -0.3394498166055352, -0.8960153384461487, -0.5952850950316773, -0.6556952317439146, -0.36585861953984666]
    # immune_memory_susceptibility_levels = [0.9474824941647215, 0.8321107035678559, 0.8084361453817939, 0.5023341113704568, 0.8612870956985662, 0.7704234744914972, 0.9669889963321108]
    # mean_immunity_durations = [45.20273424474825, 157.61353784594866, 313.61220406802266, 315.3327775925308, 169.19873291097034, 361.78826275425143, 142.3577859286429]
    # random_infection_probabilities = [0.0013097699233077693, 0.0007322440813604535, 0.0004761920640213405, 8.214404801600534e-6]

    # 8
    # duration_parameter = 4.277759253084362
    # susceptibility_parameters = [6.8329443147715905, 5.780260086695566, 5.315771923974658, 5.063687895965322, 6.6882294098032675, 7.6638879626542185, 5.922640880293431]
    # temperature_parameters = [-0.6520640213404468, -0.8250416805601867, -0.19123041013671227, -0.6995998666222074, -0.5820806935645215, -0.9584061353784595, -0.2823407802600868]
    # immune_memory_susceptibility_levels = [0.6153717905968656, 0.6278759586528843, 0.5246748916305435, 0.7734244748249417, 0.6198732910970324, 0.6982327442480827, 0.7484161387129042]
    # mean_immunity_durations = [130.1990663554518, 62.867289096365454, 347.56485495165055, 351.5795265088363, 219.66888962987662, 175.16338779593198, 285.16538846282094]
    # random_infection_probabilities = [0.0011100366788929644, 0.0005998666222074025, 0.0003511503834611537, 5.69356452150717e-6]

    # 9
    # duration_parameter = 4.792930976992331
    # susceptibility_parameters = [6.195731910636879, 3.14971657219073, 4.468489496498833, 5.511837279093031, 4.37512504168056, 1.2847615871957319, 2.869623207735912]
    # temperature_parameters = [-0.15458819606535512, -0.6523941313771258, -0.24206735578526173, -0.9115305101700567, -0.44145381793931315, -0.36783927975992003, -0.15293764588196057]
    # immune_memory_susceptibility_levels = [0.7772590863621207, 0.9353117705901968, 0.6702234078026008, 0.778759586528843, 0.525675225075025, 0.8662887629209737, 0.6732244081360453]
    # mean_immunity_durations = [297.8976325441814, 248.23041013671224, 111.73157719239747, 292.0476825608536, 72.38779593197732, 249.72157385795265, 61.72024008002668]
    # random_infection_probabilities = [0.0016055351783927977, 0.0005126708902967656, 0.0002865288429476492, 9.854951650550183e-6]

    # 10
    # duration_parameter = 4.803934644881627
    # susceptibility_parameters = [4.16972324108036, 4.645881960653551, 4.533844614871624, 6.62054018006002, 4.062354118039346, 5.773257752584195, 7.729243081027009]
    # temperature_parameters = [-0.6474424808269423, -0.888752917639213, -0.48832944314771587, -0.5593031010336779, -0.9775525175058353, -0.7930210070023341, -0.3292164054684895]
    # immune_memory_susceptibility_levels = [0.6787262420806935, 0.8309436478826275, 0.5995331777259086, 0.5348449483161054, 0.5055018339446482, 0.5468489496498833, 0.7605868622874292]
    # mean_immunity_durations = [117.58152717572524, 320.3797932644215, 140.8666222074025, 295.3741247082361, 58.62320773591197, 73.30543514504835, 58.852617539179725]
    # random_infection_probabilities = [0.0010860286762254085, 0.0007539179726575526, 0.0003616538846282094, 9.52484161387129e-6]

    # 11
    # duration_parameter = 4.486828942980994
    # susceptibility_parameters = [6.863287762587529, 3.8429476492164056, 5.140713571190397, 4.2630876958986335, 3.063354451483828, 5.955318439479827, 7.22974324774925]
    # temperature_parameters = [-0.6817739246415472, -0.3826942314104702, -0.09615871957319111, -0.29818606202067366, -0.3711403801267089, -0.2486695565188397, -0.7672724241413804]
    # immune_memory_susceptibility_levels = [0.7140713571190397, 0.804434811603868, 0.9226408802934312, 0.7297432477492498, 0.7605868622874292, 0.9449816605535178, 0.5015005001667222]
    # mean_immunity_durations = [35.10870290096699, 255.57152384128042, 297.6682227409136, 317.28276092030677, 198.56318772924308, 311.0886962320774, 178.48982994331445]
    # random_infection_probabilities = [0.0010333444481493831, 0.0006943981327109036, 0.0003058352784261421, 8.021007002334112e-6]

    # 12
    # duration_parameter = 4.680893631210403
    # susceptibility_parameters = [7.586862287429143, 4.564188062687562, 3.3877959319773256, 5.980993664554852, 7.498166055351784, 5.6868956318772925, 5.68922974324775]
    # temperature_parameters = [-0.4104234744914972, -0.24107702567522515, -0.46324108036012, -0.7672724241413804, -0.799623207735912, -0.4295698566188729, -0.3675091697232411]
    # immune_memory_susceptibility_levels = [0.7947649216405468, 0.8946315438479493, 0.8449483161053685, 0.8181060353451151, 0.8504501500500167, 0.6862287429143048, 0.5058352784261421]
    # mean_immunity_durations = [189.1573857952651, 274.1537179059686, 271.05668556185395, 49.79093031010336, 75.94364788262754, 175.0486828942981, 88.33177725908637]
    # random_infection_probabilities = [0.0013507835945315105, 0.0009828276092030677, 0.0002450150050016672, 6.95731910636879e-6]

    # 13
    # duration_parameter = 4.984994998332778
    # susceptibility_parameters = [2.5241747249083026, 3.7682560853617875, 3.798599533177726, 5.385795265088363, 6.828276092030677, 3.513837945981994, 4.181393797932644]
    # temperature_parameters = [-0.7461453817939313, -0.8451783927975992, -0.44046348782927647, -0.9022874291430477, -0.577789263087696, -0.9795331777259086, -0.1856185395131711]
    # immune_memory_susceptibility_levels = [0.565188396132044, 0.883461153717906, 0.6015338446148716, 0.733411137045682, 0.6905635211737245, 0.5646882294098032, 0.5060020006668889]
    # mean_immunity_durations = [249.377459153051, 67.45548516172057, 286.8859619873291, 341.485495165055, 130.3137712570857, 334.2590863621207, 354.67655885295096]
    # random_infection_probabilities = [0.0010023341113704568, 0.0009376458819606536, 0.00044668222740913645, 1.4389796598866288e-5]
    
    # 14
    duration_parameter = 4.964988329443148
    susceptibility_parameters = [2.792597532510837, 4.92597532510837, 2.3631210403467824, 7.547182394131377, 6.739579859953317, 5.966988996332111, 4.3027675891963995]
    temperature_parameters = [-0.44706568856285434, -0.8811603867955985, -0.8600333444481494, -0.8937045681893965, -0.3556252084028009, -0.6332477492497499, -0.23282427475825285]
    immune_memory_susceptibility_levels = [0.8504501500500167, 0.5335111703901301, 0.6502167389129709, 0.7077359119706569, 0.6698899633211071, 0.8616205401800601, 0.9666555518506168]
    mean_immunity_durations = [110.12570856952317, 206.8219406468823, 36.14104701567189, 89.70823607869289, 298.241747249083, 47.152717572524175, 152.45181727242414]
    random_infection_probabilities = [0.0016518839613204402, 0.000782427475825275, 0.0003634544848282761, 6.073691230410137e-6]

    # 15
    duration_parameter = 4.5078359453151045
    susceptibility_parameters = [6.410470156718906, 5.9109703234411475, 2.0620206735578526, 7.708236078692898, 1.553184394798266, 6.954318106035345, 7.036012004001334]
    temperature_parameters = [-0.7213871290430143, -0.9471823941313772, -0.3113904634878293, -0.3044581527175726, -0.8874324774924975, -0.48799933311103705, -0.23051350450150043]
    immune_memory_susceptibility_levels = [0.72324108036012, 0.9849949983327776, 0.7585861953984662, 0.9051350450150051, 0.9118039346448816, 0.735245081693898, 0.5996998999666555]
    mean_immunity_durations = [362.59119706568856, 37.6322107369123, 209.23074358119374, 171.03401133711236, 92.69056352117373, 250.98332777592532, 121.48149383127709]
    random_infection_probabilities = [0.0015341780593531177, 0.0009139713237745915, 0.00032184061353784596, 7.39079693231077e-6]

    # 16
    duration_parameter = 4.770923641213738
    susceptibility_parameters = [3.4974991663887964, 4.188396132044015, 1.6838946315438479, 4.396132044014672, 2.435478492830944, 6.7675891963987995, 5.8712904301433815]
    temperature_parameters = [-0.13280093364454815, -0.5814204734911638, -0.9986795598532844, -0.587032344114705, -0.18660886962320766, -0.5418072690896967, -0.9286962320773591]
    immune_memory_susceptibility_levels = [0.9591530510170057, 0.6585528509503168, 0.9398132710903635, 0.5141713904634878, 0.5783594531510503, 0.7540846948982994, 0.7499166388796266]
    mean_immunity_durations = [290.78592864288095, 204.98666222074024, 359.49416472157384, 172.4104701567189, 164.26642214071356, 156.351783927976, 347.67955985328445]
    random_infection_probabilities = [0.001796265421807269, 0.0008306102034011337, 0.0003571523841280427, 5.723574524841614e-6]

    # 17
    duration_parameter = 4.839946648882961
    susceptibility_parameters = [5.280760253417806, 3.434478159386462, 3.8312770923641213, 6.4128042680893635, 5.084694898299433, 6.9263087695898635, 6.216738912970991]
    temperature_parameters = [-0.6068389463154384, -0.5147382460820273, -0.8455085028342781, -0.3754318106035346, -0.27936978992997663, -0.920113371123708, -0.14105368456152045]
    immune_memory_susceptibility_levels = [0.5231743914638213, 0.9911637212404134, 0.5350116705568523, 0.903134378126042, 0.7237412470823608, 0.6152050683561188, 0.5975325108369457]
    mean_immunity_durations = [313.4974991663888, 83.17005668556186, 235.26875625208402, 111.73157719239747, 201.77492497499168, 279.2007335778593, 81.44948316105368]
    random_infection_probabilities = [0.0013494498166055353, 0.0008769589863287763, 0.00028232744248082696, 1.4063021007002335e-5]
        
    # 18
    duration_parameter = 4.995998666222074
    susceptibility_parameters = [4.445148382794265, 7.136378792930977, 5.509503167722574, 6.657885961987329, 3.838279426475492, 2.3677892630876958, 4.293431143714571]
    temperature_parameters = [-0.5810903634544848, -0.5946248749583194, -0.45201733911303765, -0.8963454484828276, -0.9148316105368456, -0.8996465488496166, -0.4979026342114038]
    immune_memory_susceptibility_levels = [0.5950316772257419, 0.6905635211737245, 0.9373124374791597, 0.6880626875625209, 0.9856618872957652, 0.9068022674224742, 0.5311770590196733]
    mean_immunity_durations = [271.05668556185395, 215.53951317105702, 104.2757585861954, 354.4471490496832, 210.26308769589863, 182.50450150050017, 143.50483494498167]
    random_infection_probabilities = [0.0012480826942314104, 0.0008404468156052018, 0.00032744248082694234, 8.147715905301768e-6]

    # 19
    duration_parameter = 4.065688562854285
    susceptibility_parameters = [4.517505835278426, 7.703567855951984, 3.231410470156719, 6.020673557852618, 1.0933644548182728, 6.177059019673225, 5.801267089029676]
    temperature_parameters = [-0.32987662554184727, -0.39721907302434145, -0.36123707902634206, -0.5503901300433478, -0.38302434144714903, -0.6537145715238413, -0.7557185728576192]
    immune_memory_susceptibility_levels = [0.6187062354118039, 0.7805935311770591, 0.8199399799933311, 0.7827609203067689, 0.652217405801934, 0.5270090030010003, 0.802267422474158]
    mean_immunity_durations = [38.435145048349455, 207.39546515505168, 49.446815605201735, 285.28009336445484, 232.63054351450484, 174.4751583861287, 240.43047682560854]
    random_infection_probabilities = [0.0019416472157385795, 0.0008047682560853619, 0.00023171057019006337, 1.2699233077692565e-5]

    # 20
    duration_parameter = 3.985661887295765
    susceptibility_parameters = [2.1647215738579524, 3.772924308102701, 7.880960320106702, 7.829609869956652, 3.4041347115705234, 6.251750583527842, 5.563187729243081]
    temperature_parameters = [-0.5616138712904302, -0.8686162054018006, -0.303137712570857, -0.21631877292430823, -0.6081593864621542, -0.9996698899633211, -0.6292864288096032]
    immune_memory_susceptibility_levels = [0.7249083027675892, 0.7047349116372124, 0.9554851617205735, 0.9244748249416472, 0.5883627875958652, 0.5780260086695566, 0.6817272424141381]
    mean_immunity_durations = [27.652884294764924, 235.03934644881627, 303.9769923307769, 149.12537512504167, 44.97332444148049, 39.81160386795598, 327.14738246082027]
    random_infection_probabilities = [0.0016472157385795266, 0.0008476158719573191, 0.0004826942314104702, 1.1078692897632545e-5]

    # 21
    duration_parameter = 4.7459153051017005
    susceptibility_parameters = [3.39946648882961, 3.2617539179726576, 2.2324108036012005, 6.57619206402134, 5.612204068022674, 5.705568522840947, 4.167389129709903]
    temperature_parameters = [-0.4510270090030011, -0.81810936978993, -0.7461453817939313, -0.8332944314771591, -0.4490463487829277, -0.17703567855951974, -0.7917005668556185]
    immune_memory_susceptibility_levels = [0.5995331777259086, 0.7877625875291764, 0.9654884961653885, 0.7899299766588863, 0.5141713904634878, 0.731077025675225, 0.8974658219406468]
    mean_immunity_durations = [62.40846948982994, 123.66088696232077, 345.1560520173391, 163.1193731243748, 153.36945648549516, 311.7769256418806, 91.08469489829943]
    random_infection_probabilities = [0.0013074358119373125, 0.000992497499166389, 0.0002465155051683895, 1.0445148382794264e-5]

    # 22
    duration_parameter = 4.849949983327775
    susceptibility_parameters = [5.794264754918306, 4.67622540846949, 2.7085695231743916, 6.230743581193731, 4.07402467489163, 4.7765921973991325, 5.427809269756586]
    temperature_parameters = [-0.1403934644881627, -0.7933511170390131, -0.8841313771257086, -0.395568522840947, -0.3186528842947649, -0.9646782260753585, -0.4609303101033677]
    immune_memory_susceptibility_levels = [0.8352784261420474, 0.5805268422807602, 0.6910636878959653, 0.5028342780926975, 0.573191063687896, 0.5001667222407469, 0.5915305101700566]
    mean_immunity_durations = [112.30510170056685, 192.7132377459153, 107.83161053684562, 298.8152717572524, 56.9026342114038, 249.377459153051, 140.52250750250084]
    random_infection_probabilities = [0.001093031010336779, 0.0007204068022674225, 0.000391463821273758, 6.653884628209403e-6]

    # 23
    duration_parameter = 4.674891630543515
    susceptibility_parameters = [6.020673557852618, 3.602534178059353, 1.9639879959986661, 5.234078026008669, 6.485161720573524, 6.968322774258086, 6.821273757919307]
    temperature_parameters = [-0.590003334444815, -0.327895965321774, -0.04499166388796261, -0.2556018672890964, -0.3176625541847282, -0.6570156718906303, -0.6160820273424474]
    immune_memory_susceptibility_levels = [0.6052017339113038, 0.9879959986662221, 0.51567189063021, 0.6698899633211071, 0.8246082027342447, 0.5660220073357786, 0.8651217072357453]
    mean_immunity_durations = [330.8179393131044, 193.51617205735246, 134.5578526175392, 360.41180393464487, 330.8179393131044, 31.552850950316774, 279.6595531843948]
    random_infection_probabilities = [0.0017829276425475158, 0.0006102034011337112, 0.0003996665555185062, 8.831277092364122e-6]

    # 24
    duration_parameter = 4.910970323441147
    susceptibility_parameters = [1.928976325441814, 5.929643214404802, 5.201400466822274, 7.2157385795265085, 3.320106702234078, 2.2417472490830277, 3.81027009003001]
    temperature_parameters = [-0.151947315771924, -0.0298066022007335, -0.7613304434811604, -0.5563321107035679, -0.7514271423807936, -0.3209636545515171, -0.7497765921973991]
    immune_memory_susceptibility_levels = [0.6000333444481494, 0.8896298766255418, 0.8711237079026342, 0.7694231410470156, 0.6192064021340447, 0.9543181060353452, 0.5291763921307102]
    mean_immunity_durations = [210.0336778926309, 135.47549183061022, 88.56118706235412, 223.9129709903301, 236.87462487495833, 130.8872957652551, 40.958652884294764]
    random_infection_probabilities = [0.001271090363454485, 0.0007995998666222074, 0.00039856618872957656, 9.124708236078693e-6]

    # 25
    duration_parameter = 4.907969323107702
    susceptibility_parameters = [2.477492497499166, 4.890963654551517, 4.636545515171724, 4.461487162387463, 3.4554851617205737, 6.552850950316772, 4.9866622207402465]
    temperature_parameters = [-0.9217639213071024, -0.2896032010670223, -0.7303001000333444, -0.12817939313104365, -0.6411703901300434, -0.6725308436145382, -0.6675791930643549]
    immune_memory_susceptibility_levels = [0.6662220740246749, 0.5733577859286428, 0.8291097032344115, 0.7299099699899967, 0.9946648882960987, 0.7507502500833612, 0.7712570856952318]
    mean_immunity_durations = [296.06235411803937, 241.46282094031343, 90.96998999666556, 253.6215405135045, 122.28442814271423, 35.22340780260087, 362.2470823607869]
    random_infection_probabilities = [0.0012600866955651885, 0.0005390130043347783, 0.00022520840280093366, 8.657885961987329e-6]

    # 26
    duration_parameter = 4.349783261087029
    susceptibility_parameters = [2.717905968656219, 5.7662554184728245, 4.645881960653551, 5.598199399799934, 3.8802934311437145, 7.043014338112704, 6.816605535178393]
    temperature_parameters = [-0.870596865621874, -0.9924074691563854, -0.21928976325441818, -0.5170490163387796, -0.8692764254751584, -0.6461220406802268, -0.5325641880626876]
    immune_memory_susceptibility_levels = [0.8844614871623875, 0.8541180393464488, 0.7690896965655218, 0.871623874624875, 0.8941313771257086, 0.5466822274091364, 0.6533844614871624]
    mean_immunity_durations = [167.93697899299767, 101.1787262420807, 199.25141713904634, 311.0886962320774, 36.026342114038016, 167.93697899299767, 99.80226742247416]
    random_infection_probabilities = [0.0011803934644881628, 0.0008604534844948316, 0.0003152384128042681, 1.1988996332110704e-5]

    # 27
    duration_parameter = 4.693897965988663
    susceptibility_parameters = [2.923307769256419, 6.695231743914638, 5.108036012004002, 6.233077692564188, 4.284094698232744, 5.68922974324775, 4.137045681893964]
    temperature_parameters = [-0.15260753584528175, -0.27012670890296775, -0.11332444148049359, -0.648432810936979, -0.5061553851283762, -0.6487629209736578, -0.07239079693231076]
    immune_memory_susceptibility_levels = [0.5763587862620874, 0.7142380793597866, 0.7364121373791264, 0.673891297099033, 0.5648549516505502, 0.6385461820606869, 0.8402800933644547]
    mean_immunity_durations = [285.96832277425807, 150.73124374791598, 194.20440146715572, 363.3941313771257, 24.097032344114705, 129.16672224074694, 210.49249749916638]
    random_infection_probabilities = [0.001776925641880627, 0.0008749583194398133, 0.00032054018006002, 7.877625875291764e-6]

    # 28
    duration_parameter = 4.799933311103701
    susceptibility_parameters = [4.1183727909303105, 7.579859953317772, 2.0386795598532848, 3.807935978659553, 7.775925308436145, 1.4458152717572523, 7.138712904301434]
    temperature_parameters = [-0.3698199399799933, -0.2057552517505835, -0.9343081027009003, -0.3199733244414804, -0.8025941980660221, -0.23744581527175723, -0.7491163721240414]
    immune_memory_susceptibility_levels = [0.8322774258086029, 0.8621207069023007, 0.8689563187729243, 0.9146382127375792, 0.575025008336112, 0.7837612537512504, 0.5233411137045682]
    mean_immunity_durations = [239.16872290763587, 125.15205068356119, 318.8886295431811, 311.2034011337112, 21.917639213071023, 197.9896632210737, 36.48516172057352]
    random_infection_probabilities = [0.0017299099699899967, 0.0009611537179059687, 0.000276325441813938, 1.4773257752584195e-5]

    # 29
    duration_parameter = 4.799933311103701
    susceptibility_parameters = [4.1183727909303105, 7.579859953317772, 2.0386795598532848, 3.807935978659553, 7.775925308436145, 1.4458152717572523, 7.138712904301434]
    temperature_parameters = [-0.3698199399799933, -0.2057552517505835, -0.9343081027009003, -0.3199733244414804, -0.8025941980660221, -0.23744581527175723, -0.7491163721240414]
    immune_memory_susceptibility_levels = [0.8322774258086029, 0.8621207069023007, 0.8689563187729243, 0.9146382127375792, 0.575025008336112, 0.7837612537512504, 0.5233411137045682]
    mean_immunity_durations = [239.16872290763587, 125.15205068356119, 318.8886295431811, 311.2034011337112, 21.917639213071023, 197.9896632210737, 36.48516172057352]
    random_infection_probabilities = [0.0017299099699899967, 0.0009611537179059687, 0.000276325441813938, 1.4773257752584195e-5]

    # 30
    duration_parameter = 4.53784594864955
    susceptibility_parameters = [3.978326108702901, 4.412470823607869, 4.834944981660554, 7.145715238412804, 2.7575858619539844, 2.2697565855285093, 4.004001333777926]
    temperature_parameters = [-0.897995998666222, -0.2067455818606203, -0.051593864621540475, -0.06479826608869621, -0.6553651217072358, -0.9359586528842948, -0.9316672224074691]
    immune_memory_susceptibility_levels = [0.9323107702567522, 0.6983994664888296, 0.8947982660886962, 0.7929309769923307, 0.6785595198399467, 0.9514838279426476, 0.7510836945648549]
    mean_immunity_durations = [335.52084028009335, 190.76325441813938, 232.63054351450484, 346.99133044348116, 100.94931643881294, 264.1743914638213, 196.8426142047349]
    random_infection_probabilities = [0.0012400800266755586, 0.000780593531177059, 0.00031823941313771257, 1.1018672890963654e-5]

    # 31
    duration_parameter = 4.818939646548849
    susceptibility_parameters = [2.097032344114705, 7.4538179393131045, 6.492164054684895, 4.571190396798933, 2.125041680560187, 6.296098699566522, 5.95298432810937]
    temperature_parameters = [-0.7474658219406469, -0.1625108369456485, -0.20608536178726244, -0.08988662887629217, -0.037399133044348054, -0.5292630876958986, -0.7177559186395466]
    immune_memory_susceptibility_levels = [0.5381793931310437, 0.8157719239746581, 0.9143047682560854, 0.7694231410470156, 0.8112704234744915, 0.7427475825275092, 0.9258086028676226]
    mean_immunity_durations = [39.69689896632211, 23.064688229409803, 175.27809269756585, 243.52750916972323, 212.90130043347781, 191.91030343447815, 57.246748916305435]
    random_infection_probabilities = [0.0010516838946315438, 0.0005456818939646549, 0.00034124708236078695, 8.984661553851284e-6]

    # 32
    duration_parameter = 3.9556518839613206
    susceptibility_parameters = [6.0160053351117035, 4.888629543181061, 1.347782594198066, 6.709236412137379, 7.619539846615538, 5.623874624874959, 4.015671890630211]
    temperature_parameters = [-0.26352450816938977, -0.9570856952317439, -0.23216405468489498, -0.8227309103034345, -0.5946248749583194, -0.8240513504501501, -0.08559519839946639]
    immune_memory_susceptibility_levels = [0.8252750916972325, 0.6702234078026008, 0.7167389129709903, 0.6470490163387796, 0.7140713571190397, 0.8954651550516839, 0.5840280093364455]
    mean_immunity_durations = [322.10036678892965, 37.861620540180056, 359.49416472157384, 311.0886962320774, 161.74291430476825, 293.538846282094, 321.756252084028]
    random_infection_probabilities = [0.00165621873957986, 0.0006573857952650884, 0.0003241413804601534, 9.748249416472158e-6]

    # 33
    duration_parameter = 4.12270756918973
    susceptibility_parameters = [7.115371790596866, 5.262087362454151, 2.160053351117039, 5.983327775925308, 7.243747915971991, 6.076692230743581, 3.0610203401133713]
    temperature_parameters = [-0.010660220073357762, -0.10936312104034673, -0.36783927975992003, -0.06578859619873301, -0.062157385795265085, -0.08559519839946639, -0.6296165388462821]
    immune_memory_susceptibility_levels = [0.6150383461153718, 0.7400800266755585, 0.6548849616538847, 0.6968989663221073, 0.926975658552851, 0.6935645215071691, 0.9089696565521841]
    mean_immunity_durations = [73.5348449483161, 193.17205735245082, 141.32544181393797, 305.4681560520173, 315.218072690897, 169.65755251750585, 363.9676558852951]
    random_infection_probabilities = [0.0018009336445481828, 0.0007275758586195399, 0.0004936978992997666, 1.2415805268422807e-5]

    # 34
    duration_parameter = 4.3987995998666225
    susceptibility_parameters = [5.95298432810937, 6.982327442480827, 2.4401467155718572, 5.005335111703901, 2.542847615871957, 6.251750583527842, 4.5665221740580195]
    temperature_parameters = [-0.8989863287762587, -0.2869623207735912, -0.7976425475158386, -0.6101400466822273, -0.34143047682560856, -0.5860420140046683, -0.5474191397132377]
    immune_memory_susceptibility_levels = [0.9006335445148383, 0.782594198066022, 0.6890630210070023, 0.5558519506502168, 0.754918306102034, 0.5160053351117039, 0.903134378126042]
    mean_immunity_durations = [65.39079693231076, 245.2480826942314, 64.93197732577525, 337.2414138046015, 168.05168389463154, 159.10470156718907, 222.07769256418806]
    random_infection_probabilities = [0.0014578192730910304, 0.0009059686562187396, 0.0003652550850283428, 1.3719573191063686e-5]

    # 35
    duration_parameter = 4.930976992330777
    susceptibility_parameters = [7.5331777259086365, 6.303101033677892, 4.575858619539847, 4.792930976992331, 6.779259753251083, 6.356785595198399, 3.5068356118706236]
    temperature_parameters = [-0.33911970656885626, -0.543457819273091, -0.6834244748249416, -0.5348749583194398, -0.010660220073357762, -0.3721307102367456, -0.20179393131043677]
    immune_memory_susceptibility_levels = [0.8487829276425476, 0.7484161387129042, 0.504001333777926, 0.5640213404468156, 0.8652884294764922, 0.6773924641547182, 0.7794264754918305]
    mean_immunity_durations = [292.96532177392464, 78.8112704234745, 158.8752917639213, 301.68289429809937, 101.06402134044681, 265.32144048016005, 91.7729243081027]
    random_infection_probabilities = [0.0012374124708236078, 0.0008464488162720907, 0.0004723907969323108, 1.0175058352784261e-5]

    # 36
    duration_parameter = 4.47782594198066
    susceptibility_parameters = [4.445148382794265, 4.4474824941647215, 5.819939979993331, 6.748916305435145, 3.2640880293431143, 2.5498499499833276, 4.67622540846949]
    temperature_parameters = [-0.05027342447482497, -0.11728576192064033, -0.666918972990997, -0.7306302100700233, -0.6692297432477492, -0.41570523507835944, -0.45795931977325777]
    immune_memory_susceptibility_levels = [0.5508502834278093, 0.5816938979659887, 0.7245748582860954, 0.5920306768922974, 0.6783927975991997, 0.9221407135711903, 0.6157052350783594]
    mean_immunity_durations = [197.07202400800267, 25.358786262087364, 96.13171057019007, 348.5971990663555, 182.7339113037679, 100.83461153717906, 255.91563854618207]
    random_infection_probabilities = [0.0010166722240746917, 0.0006998999666555519, 0.0004166722240746916, 1.4529843281093696e-5]

    # 37
    duration_parameter = 3.9416472157385796
    susceptibility_parameters = [4.846615538512838, 4.851283761253751, 7.117705901967322, 5.873624541513838, 5.453484494831611, 3.9316438812937644, 7.649883294431477]
    temperature_parameters = [-0.10144048016005325, -0.9478426142047349, -0.03343781260420142, -0.7022407469156385, -0.7586895631877293, -0.6375391797265755, -0.6860653551183729]
    immune_memory_susceptibility_levels = [0.9196398799599866, 0.6183727909303101, 0.519673224408136, 0.7890963654551517, 0.962487495831944, 0.5155051683894631, 0.7715905301767256]
    mean_immunity_durations = [183.4221407135712, 276.3331110370124, 65.04668222740914, 158.8752917639213, 311.8916305435145, 163.69289763254417, 111.61687229076358]
    random_infection_probabilities = [0.0013194398132710904, 0.0006647215738579526, 0.0004621873957985996, 9.758252750916971e-6]

    # 38
    duration_parameter = 4.802934311437146
    susceptibility_parameters = [5.971657219073024, 4.92597532510837, 7.780593531177059, 7.918306102034012, 4.090363454484828, 6.020673557852618, 3.189396465488496]
    temperature_parameters = [-0.20707569189729913, -0.04334111370456817, -0.9481727242414137, -0.04400133377792603, -0.30775925308436136, -0.46027009003000996, -0.5626042014004669]
    immune_memory_susceptibility_levels = [0.5273424474824941, 0.5751917305768589, 0.5301767255751917, 0.5421807269089697, 0.6337112370790263, 0.8139379793264421, 0.9191397132377459]
    mean_immunity_durations = [220.70123374458151, 88.56118706235412, 88.21707235745248, 322.21507169056355, 58.73791263754585, 235.72757585861953, 68.71723907969323]
    random_infection_probabilities = [0.0016568856285428476, 0.0009006335445148382, 0.00028192730910303436, 5.583527842614205e-6]

    # 39
    duration_parameter = 4.7459153051017005
    susceptibility_parameters = [5.0006668889629875, 3.581527175725242, 3.6865621873957988, 4.900300100033345, 6.1863954651550515, 3.2220740246748916, 5.537512504168056]
    temperature_parameters = [-0.06974991663887953, -0.799623207735912, -0.29587529176392124, -0.2463587862620873, -0.587032344114705, -0.06743914638212734, -0.33317772590863626]
    immune_memory_susceptibility_levels = [0.8916305435145049, 0.8949649883294432, 0.8417805935311771, 0.9974991663887962, 0.6725575191730577, 0.8889629876625542, 0.5145048349449817]
    mean_immunity_durations = [272.66255418472826, 210.0336778926309, 290.21240413471156, 303.2887629209737, 327.4914971657219, 283.9036345448483, 275.759586528843]
    random_infection_probabilities = [0.0010583527842614206, 0.0007434144714904968, 0.0003135378459486496, 1.2162387462487496e-5]

    # 40
    duration_parameter = 4.688896298766256
    susceptibility_parameters = [3.4671557185728576, 7.708236078692898, 5.385795265088363, 4.0133377792597535, 5.143047682560853, 5.432477492497499, 7.073357785928643]
    temperature_parameters = [-0.577789263087696, -0.8511203734578192, -0.24140713571190398, -0.5424674891630543, -0.03706902300766923, -0.40415138379459814, -0.8299933311103701]
    immune_memory_susceptibility_levels = [0.9404801600533511, 0.8779593197732578, 0.6068689563187729, 0.962320773591197, 0.7189063021007003, 0.7735911970656886, 0.8846282094031344]
    mean_immunity_durations = [346.4178059353118, 110.0110036678893, 65.39079693231076, 344.12370790263424, 363.6235411803935, 210.26308769589863, 79.95831943981327]
    random_infection_probabilities = [0.0010710236745581862, 0.0007969323107702567, 0.0002978326108702901, 9.224741580526843e-6]

    # 41
    duration_parameter = 4.995998666222074
    susceptibility_parameters = [4.720573524508169, 7.507502500833612, 2.365455151717239, 7.220406802267423, 3.9433144381460488, 2.6408802934311435, 7.460820273424475]
    temperature_parameters = [-0.14237412470823607, -0.9204434811603868, -0.22226075358452813, -0.02782594198066013, -0.09087695898632875, -0.31205068356118715, -0.4292397465821941]
    immune_memory_susceptibility_levels = [0.656052017339113, 0.5958652884294765, 0.557519173057686, 0.8154384794931644, 0.5748582860953652, 0.9888296098699567, 0.7789263087695899]
    mean_immunity_durations = [100.49049683227743, 232.2864288096032, 175.16338779593198, 185.83094364788263, 312.80926975658554, 325.4268089363121, 92.46115371790597]
    random_infection_probabilities = [0.0010903634544848283, 0.000527842614204735, 0.00025481827275758586, 1.1692230743581193e-5]

    # 42
    duration_parameter = 3.8366122040680226
    susceptibility_parameters = [5.623874624874959, 4.937645881960654, 2.5521840613537847, 7.073357785928643, 5.500166722240747, 6.545848616205402, 7.549516505501834]
    temperature_parameters = [-0.8702667555851951, -0.29587529176392124, -0.17703567855951974, -0.32987662554184727, -0.018582860953651248, -0.5698666222074025, -0.16185061687229074]
    immune_memory_susceptibility_levels = [0.705568522840947, 0.9688229409803268, 0.5068356118706235, 0.7314104701567189, 0.8426142047349117, 0.800266755585195, 0.8046015338446149]
    mean_immunity_durations = [189.6162054018006, 235.26875625208402, 76.6318772924308, 317.28276092030677, 349.8589529843281, 309.94164721573856, 192.59853284428144]
    random_infection_probabilities = [0.0011213737912637545, 0.0008121040346782261, 0.0002647215738579527, 8.721240413471157e-6]

    # 43
    duration_parameter = 4.847949316438813
    susceptibility_parameters = [6.998666222074025, 6.800266755585195, 3.667889296432144, 6.744248082694232, 2.5078359453151053, 3.4788262754251416, 6.888962987662554]
    temperature_parameters = [-0.8897432477492497, -0.18891963987996008, -0.3549649883294431, -0.08196398799599869, -0.7576992330776926, -0.42527842614204736, -0.43320106702234085]
    immune_memory_susceptibility_levels = [0.7369123041013671, 0.6327109036345449, 0.5916972324108036, 0.5265088362787596, 0.9039679893297765, 0.9816605535178393, 0.5453484494831611]
    mean_immunity_durations = [36.82927642547516, 160.71057019006335, 339.4208069356452, 196.15438479493164, 114.94331443814605, 97.04934978326109, 81.3347782594198]
    random_infection_probabilities = [0.0014698232744248083, 0.0009553184394798266, 0.0004700900300100033, 1.1552184061353785e-5]

    # 44
    duration_parameter = 4.690896965655218
    susceptibility_parameters = [2.8252750916972325, 6.069689896632211, 3.2874291430476825, 5.385795265088363, 1.9173057685895298, 3.203401133711237, 7.911303767922641]
    temperature_parameters = [-0.8587129043014339, -0.5094564854951651, -0.41933644548182725, -0.5233211070356786, -0.8151383794598199, -0.6939879959986662, -0.8045748582860953]
    immune_memory_susceptibility_levels = [0.8436145381793931, 0.87945981993998, 0.7957652550850283, 0.8126042014004669, 0.9173057685895298, 0.5643547849283095, 0.8786262087362454]
    mean_immunity_durations = [243.06868956318772, 323.47682560853616, 86.38179393131044, 266.2390796932311, 293.6535511837279, 309.36812270756917, 182.96332110703568]
    random_infection_probabilities = [0.0018239413137712572, 0.0008751250416805602, 0.00032704234744914974, 9.168056018672891e-6]

    # 45
    duration_parameter = 4.731910636878959
    susceptibility_parameters = [1.7702567522507504, 3.1520506835611872, 7.220406802267423, 4.9469823274424805, 6.91463821273758, 7.645215071690563, 6.471157052350784]
    temperature_parameters = [-0.9343081027009003, -0.5672257419139712, -0.8956852284094698, -0.49262087362454154, -0.03343781260420142, -0.5886828942980994, -0.7474658219406469]
    immune_memory_susceptibility_levels = [0.5791930643547849, 0.5925308436145382, 0.6415471823941314, 0.940813604534845, 0.5451817272424141, 0.5741913971323774, 0.7434144714904969]
    mean_immunity_durations = [239.39813271090364, 311.0886962320774, 159.3341113704568, 211.75425141713905, 150.96065355118373, 162.43114371457153, 282.0683561187062]
    random_infection_probabilities = [0.0012264088029343115, 0.0006900633544514839, 0.000372757585861954, 6.250416805601868e-6]

    # 46
    duration_parameter = 3.4604868289429813
    susceptibility_parameters = [2.855618539513171, 6.7279093031010335, 7.554184728242747, 7.6918972990997, 7.703567855951984, 7.514504834944981, 4.137045681893964]
    temperature_parameters = [-0.8537612537512504, -0.5513804601533845, -0.5101167055685227, -0.12619873291097028, -0.39589863287762583, -0.8138179393131044, -0.5758086028676226]
    immune_memory_susceptibility_levels = [0.7279093031010337, 0.6783927975991997, 0.8729576525508502, 0.7060686895631877, 0.9878292764254751, 0.5768589529843281, 0.8871290430143381]
    mean_immunity_durations = [85.0053351117039, 131.23141047015673, 329.6708902967656, 180.43981327109037, 329.21207069023006, 269.2214071357119, 177.45748582860955]
    random_infection_probabilities = [0.001891297099033011, 0.0007265755251750583, 0.00024241413804601536, 1.2125708569523175e-5]

    # 47
    duration_parameter = 3.6475491830610203
    susceptibility_parameters = [2.9046348782927645, 6.144381460486829, 3.369123041013671, 6.52484161387129, 3.1707235745248417, 3.2570856952317437, 7.614871623874625]
    temperature_parameters = [-0.7748649549849951, -0.30643881293764597, -0.18198732910970328, -0.36717905968656217, -0.981513837945982, -0.16152050683561192, -0.9359586528842948]
    immune_memory_susceptibility_levels = [0.6547182394131377, 0.9978326108702901, 0.9589863287762588, 0.5396798932977659, 0.6565521840613537, 0.6615538512837613, 0.6353784594864955]
    mean_immunity_durations = [344.81193731243746, 225.40413471157052, 79.04068022674224, 68.14371457152384, 287.000666888963, 247.19806602200734, 96.36112037345782]
    random_infection_probabilities = [0.0014621540513504502, 0.0005096698899633212, 0.00031083694564854953, 1.254918306102034e-5]

    # 48
    duration_parameter = 3.985661887295765
    susceptibility_parameters = [5.150050016672224, 7.5448482827609205, 3.4718239413137715, 7.129376458819607, 4.708902967655885, 4.862954318106036, 7.684894964988329]
    temperature_parameters = [-0.25626208736245426, -0.4959219739913304, -0.7659519839946649, -0.5612837612537512, -0.4361720573524508, -0.5639246415471824, -0.1427042347449149]
    immune_memory_susceptibility_levels = [0.9041347115705235, 0.8211070356785595, 0.960653551183728, 0.5416805601867289, 0.8197732577525843, 0.7677559186395465, 0.914971657219073]
    mean_immunity_durations = [49.21740580193398, 26.964654884961654, 77.7789263087696, 244.55985328442813, 163.5781927309103, 64.81727242414138, 74.79659886628876]
    random_infection_probabilities = [0.001298432810936979, 0.0006848949649883294, 0.00022340780260086696, 1.1412137379126374e-5]

    # 49
    duration_parameter = 4.777925975325108
    susceptibility_parameters = [6.641547182394131, 3.733244414804935, 5.2784261420473495, 5.231743914638213, 6.891297099033011, 5.147715905301768, 5.922640880293431]
    temperature_parameters = [-0.22391130376792268, -0.8131577192397466, -0.485028342780927, -0.6457919306435478, -0.6979493164388129, -0.07767255751917312, -0.6444714904968323]
    immune_memory_susceptibility_levels = [0.9419806602200733, 0.5488496165388463, 0.5341780593531177, 0.6313771257085695, 0.8829609869956652, 0.770756918972991, 0.8896298766255418]
    mean_immunity_durations = [338.9619873291097, 22.14704901633878, 293.6535511837279, 161.62820940313438, 210.3777925975325, 45.77625875291764, 245.47749249749916]
    random_infection_probabilities = [0.0015921973991330444, 0.0006333777925975325, 0.00048039346448816274, 9.90163387795932e-6]

    # 50
    duration_parameter = 4.026675558519507
    susceptibility_parameters = [3.331777259086362, 6.027675891963988, 5.033344448149383, 7.234411470490163, 6.354451483827942, 1.1237079026342114, 6.478159386462154]
    temperature_parameters = [-0.9069089696565522, -0.8237212404134712, -0.05621540513504508, -0.5791097032344115, -0.35265421807269093, -0.2532910970323441, -0.48436812270756924]
    immune_memory_susceptibility_levels = [0.7575858619539846, 0.9818272757585862, 0.8542847615871958, 0.6880626875625209, 0.7989329776592198, 0.9079693231077026, 0.656052017339113]
    mean_immunity_durations = [70.20840280093364, 270.1390463487829, 251.5568522840947, 172.63987995998667, 115.05801933977993, 272.2037345781927, 245.2480826942314]
    random_infection_probabilities = [0.00134378126042014, 0.0009516505501833946, 0.00029183061020340113, 1.1705568522840947e-5]

    # 51
    duration_parameter = 4.40380126708903
    susceptibility_parameters = [6.690563521173725, 3.8569523174391462, 2.2324108036012005, 6.555185061687229, 6.450150050016672, 3.124041347115705, 4.340113371123708]
    temperature_parameters = [-0.9141713904634878, -0.9966988996332111, -0.31700233411137047, -0.9584061353784595, -0.7441647215738579, -0.13874291430476826, -0.6804534844948316]
    immune_memory_susceptibility_levels = [0.7802600866955651, 0.5045015005001667, 0.9499833277759253, 0.6608869623207736, 0.9519839946648883, 0.9449816605535178, 0.855618539513171]
    mean_immunity_durations = [339.5355118372791, 283.9036345448483, 199.93964654884962, 355.47949316438815, 342.403134378126, 234.8099366455485, 132.9519839946649]
    random_infection_probabilities = [0.0014561520506835611, 0.0006447149049683227, 0.00043497832610870296, 8.414471490496833e-6]

    # 52
    duration_parameter = 3.517505835278426
    susceptibility_parameters = [4.538512837612537, 6.17239079693231, 5.579526508836278, 7.626542180726909, 7.603201067022341, 2.5591863954651553, 6.111703901300434]
    temperature_parameters = [-0.0915371790596865, -0.31073024341447153, -0.017922640880293383, -0.8190996998999667, -0.453997999333111, -0.9217639213071024, -0.7524174724908302]
    immune_memory_susceptibility_levels = [0.6438812937645881, 0.6060353451150383, 0.7307435811937313, 0.8491163721240413, 0.7555851950650216, 0.5285095031677226, 0.8689563187729243]
    mean_immunity_durations = [356.2824274758253, 119.99033011003668, 297.324108036012, 296.1770590196732, 103.81693897965988, 207.96898966322107, 197.9896632210737]
    random_infection_probabilities = [0.001371790596865622, 0.0009534844948316106, 0.0003733577859286429, 1.3716238746248749e-5]

    # 53
    duration_parameter = 4.7279093031010335
    susceptibility_parameters = [2.909303101033678, 5.39513171057019, 4.207069023007669, 4.379793264421474, 1.8006002000666887, 2.7762587529176392, 7.710570190063354]
    temperature_parameters = [-0.9045981993997999, -0.2952150716905635, -0.8138179393131044, -0.12949983327775927, -0.13379126375458494, -0.3863254418139379, -0.9551050350116705]
    immune_memory_susceptibility_levels = [0.6020340113371123, 0.9136378792930977, 0.7462487495831944, 0.7565855285095031, 0.8376125375125041, 0.7954318106035345, 0.7314104701567189]
    mean_immunity_durations = [36.370456818939644, 65.50550183394465, 232.85995331777258, 311.0886962320774, 160.0223407802601, 336.20906968989664, 92.8052684228076]
    random_infection_probabilities = [0.0015885295098366121, 0.0009408136045348449, 0.0003251417139046349, 6.807269089696566e-6]

    # 54
    duration_parameter = 4.705901967322441
    susceptibility_parameters = [2.948982994331444, 7.010336778926309, 4.326108702900967, 3.3667889296432145, 5.630876958986328, 4.335445148382794, 6.1513837945982]
    temperature_parameters = [-0.5890130043347783, -0.25725241747249084, -0.7590196732244081, -0.7864188062687563, -0.7444948316105369, -0.8653151050350116, -0.9726008669556518]
    immune_memory_susceptibility_levels = [0.9168056018672891, 0.8076025341780593, 0.5793597865955319, 0.8169389796598867, 0.5218406135378459, 0.6148716238746249, 0.6843947982660887]
    mean_immunity_durations = [332.53851283761253, 95.09936645548517, 283.9036345448483, 96.81993997999334, 62.40846948982994, 231.36878959653217, 33.961653884628205]
    random_infection_probabilities = [0.0011747249083027677, 0.0006775591863954651, 0.0002591197065688563, 1.2702567522507502e-5]

    # 55
    duration_parameter = 4.7599199733244415
    susceptibility_parameters = [2.3584528176058686, 6.074358119373124, 6.606535511837279, 5.903967989329777, 5.759253084361454, 6.457152384128043, 4.4474824941647215]
    temperature_parameters = [-0.808866288762921, -0.10276092030676887, -0.1509569856618872, -0.3998599533177726, -0.4454151383794598, -0.6312670890296765, -0.48205735245081693]
    immune_memory_susceptibility_levels = [0.5665221740580193, 0.6618872957652551, 0.8312770923641214, 0.8102700900300099, 0.6453817939313105, 0.7754251417139046, 0.851783927975992]
    mean_immunity_durations = [307.99166388796266, 241.80693564521508, 169.8869623207736, 200.0543514504835, 87.87295765255085, 282.98599533177725, 202.5778592864288]
    random_infection_probabilities = [0.0017479159719906636, 0.0007037345781927309, 0.0003030343447815939, 5.920306768922974e-6]

    # 56
    duration_parameter = 4.810936978992998
    susceptibility_parameters = [2.132044014671557, 5.124374791597199, 7.369789929976659, 4.809269756585529, 5.103367789263087, 7.827275758586196, 4.904968322774258]
    temperature_parameters = [-0.17703567855951974, -0.18198732910970328, -0.4711637212404135, -0.8058952984328109, -0.8091963987995998, -0.14798599533177725, -0.45663887962654215]
    immune_memory_susceptibility_levels = [0.7927642547515839, 0.6260420140046682, 0.8197732577525843, 0.7922640880293431, 0.8501167055685228, 0.8626208736245415, 0.9964988329443147]
    mean_immunity_durations = [36.5998666222074, 26.964654884961654, 333.1120373457819, 144.99599866622208, 164.6105368456152, 161.054684894965, 167.93697899299767]
    random_infection_probabilities = [0.001752917639213071, 0.0008132710903634545, 0.0003962654218072691, 5.176725575191731e-6]

    # 57
    duration_parameter = 4.965988662887629
    susceptibility_parameters = [2.426142047349116, 6.968322774258086, 5.922640880293431, 4.876958986328776, 3.476492164054685, 7.547182394131377, 3.7379126375458487]
    temperature_parameters = [-0.7312904301433811, -0.39259753251083696, -0.08955651883961313, -0.919783261087029, -0.5629343114371457, -0.5332244081360453, -0.11398466155385134]
    immune_memory_susceptibility_levels = [0.7317439146382128, 0.5650216738912971, 0.8837945981993998, 0.6113704568189396, 0.6747249083027675, 0.9976658886295432, 0.5921973991330444]
    mean_immunity_durations = [200.62787595865288, 100.03167722574192, 230.90996998999665, 135.81960653551184, 355.7089029676559, 181.8162720906969, 319.34744914971657]
    random_infection_probabilities = [0.0011943981327109036, 0.0009774924974991664, 0.00023181060353451153, 9.418139379793264e-6]

    # 58
    duration_parameter = 4.561853951317106
    susceptibility_parameters = [2.7949316438812937, 5.54918306102034, 5.495498499499833, 7.990663554518172, 7.5588529509836615, 2.3281093697899298, 5.6868956318772925]
    temperature_parameters = [-0.9696298766255419, -0.5071457152384129, -0.5639246415471824, -0.3675091697232411, -0.25494164721573864, -0.8639946648882961, -0.253621207069023]
    immune_memory_susceptibility_levels = [0.9278092697565855, 0.6158719573191064, 0.9531510503501167, 0.6568856285428476, 0.7364121373791264, 0.6252084028009337, 0.9729909969989996]
    mean_immunity_durations = [294.8006002000667, 343.32077359119705, 62.17905968656219, 333.2267422474158, 172.18106035345116, 317.28276092030677, 301.3387795931977]
    random_infection_probabilities = [0.0013367789263087695, 0.0006098699566522174, 0.0004618872957652551, 9.44814938312771e-6]

    # 59
    duration_parameter = 4.9469823274424805
    susceptibility_parameters = [4.1043681227075695, 5.917972657552517, 5.768589529843281, 4.008669556518839, 2.2930976992330776, 7.059353117705902, 5.49083027675892]
    temperature_parameters = [-0.4813971323774592, -0.1450150050016673, -0.5553417805935312, -0.8778592864288096, -0.21235745248416138, -0.5949549849949983, -0.2975258419473158]
    immune_memory_susceptibility_levels = [0.5708569523174392, 0.8812937645881961, 0.5655218406135378, 0.8019339779926642, 0.9063021007002334, 0.9701567189063021, 0.6007002334111371]
    mean_immunity_durations = [95.55818606202067, 191.33677892630877, 200.74258086028675, 329.5561853951317, 273.69489829943313, 107.60220073357786, 236.5305101700567]
    random_infection_probabilities = [0.001213737912637546, 0.0008857952650883628, 0.00045908636212070694, 6.283761253751251e-6]

    # 60
    duration_parameter = 4.648882960986995
    susceptibility_parameters = [2.778592864288096, 3.219739913304435, 6.804934978326108, 5.453484494831611, 5.875958652884295, 2.4378126042014006, 6.221407135711904]
    temperature_parameters = [-0.7444948316105369, -0.09483827942647549, -0.91648216072024, -0.8709269756585529, -0.91054018006002, -0.15128709569856624, -0.7276592197399133]
    immune_memory_susceptibility_levels = [0.5, 0.8371123707902635, 0.8727909303101034, 0.877625875291764, 0.7895965321773925, 0.8091030343447816, 0.8316105368456153]
    mean_immunity_durations = [126.52850950316773, 203.6102034011337, 316.5945315105035, 148.32244081360454, 175.85161720573524, 184.56918972990997, 178.1457152384128]
    random_infection_probabilities = [0.0010583527842614206, 0.0009451483827942647, 0.0002097032344114705, 1.2062354118039346e-5]

    # 61
    duration_parameter = 3.3764588196065355
    susceptibility_parameters = [6.557519173057686, 4.708902967655885, 1.1540513504501502, 5.017005668556186, 7.019673224408136, 5.675225075025009, 7.729243081027009]
    temperature_parameters = [-0.8719173057685895, -0.7022407469156385, -0.13082027342447478, -0.8299933311103701, -0.8369256418806269, -0.16119039679893288, -0.9461920640213405]
    immune_memory_susceptibility_levels = [0.7972657552517506, 0.6550516838946315, 0.9764921640546849, 0.5056685561853951, 0.9766588862954317, 0.7800933644548182, 0.8582860953651217]
    mean_immunity_durations = [262.2244081360453, 99.11403801267089, 251.78626208736245, 71.92897632544182, 140.29309769923307, 29.48816272090697, 330.9326442147382]
    random_infection_probabilities = [0.001788262754251417, 0.0007485828609536513, 0.0004500833611203735, 1.126542180726909e-5]

    # 62
    duration_parameter = 4.5178392797599205
    susceptibility_parameters = [5.777925975325108, 5.327442480826942, 1.4038012670890296, 3.014338112704235, 5.441813937979326, 3.4181393797932644, 3.735578526175392]
    temperature_parameters = [-0.901297099033011, -0.8233911303767922, -0.14237412470823607, -0.051263754584861654, -0.46225075025008333, -0.8323041013671224, -0.29950650216738905]
    immune_memory_susceptibility_levels = [0.6295431810603535, 0.5603534511503835, 0.5778592864288096, 0.9856618872957652, 0.6675558519506501, 0.9064688229409803, 0.5586862287429143]
    mean_immunity_durations = [336.32377459153054, 342.403134378126, 162.20173391130376, 256.1450483494498, 243.2980993664555, 69.06135378459487, 115.05801933977993]
    random_infection_probabilities = [0.0011133711237079026, 0.000964488162720907, 0.00025151717239079693, 1.0618539513171055e-5]
    
    # 63
    duration_parameter = 4.780926975658553
    susceptibility_parameters = [3.4694898299433143, 7.799266422140714, 5.927309103034345, 2.923307769256419, 4.930643547849283, 6.611203734578193, 6.676558852950984]
    temperature_parameters = [-0.6144314771590531, -0.32591530510170064, -0.11365455151717241, -0.6781427142380794, -0.7425141713904635, -0.13610203401133714, -0.7458152717572524]
    immune_memory_susceptibility_levels = [0.717572524174725, 0.6220406802267422, 0.5883627875958652, 0.9144714904968323, 0.7217405801933978, 0.5075025008336113, 0.6112037345781928]
    mean_immunity_durations = [174.81927309103034, 76.74658219406469, 252.1303767922641, 237.4481493831277, 184.9133044348116, 281.9536512170724, 72.73191063687895]
    random_infection_probabilities = [0.00118972990996999, 0.0007385795265088363, 0.0003753584528176059, 1.0458486162054018e-5]

    # 64
    duration_parameter = 4.712904301433811
    susceptibility_parameters = [7.327775925308436, 6.657885961987329, 6.132710903634544, 7.122374124708236, 2.699233077692564, 3.8849616538846283, 7.297432477492498]
    temperature_parameters = [-0.38665555185061684, -0.5827409136378794, -0.9448716238746249, -0.5411470490163388, -0.4444248082694231, -0.8375858619539847, -0.7283194398132711]
    immune_memory_susceptibility_levels = [0.5720240080026675, 0.802434144714905, 0.5480160053351117, 0.5465155051683894, 0.6280426808936312, 0.5121707235745249, 0.711403801267089]
    mean_immunity_durations = [165.87229076358787, 195.81027009003, 179.52217405801935, 185.486828942981, 299.5035011670557, 99.5728576192064, 137.54018006002002]
    random_infection_probabilities = [0.0018409469823274425, 0.0008116038679559853, 0.00028352784261420475, 1.292930976992331e-5]

    # 65
    duration_parameter = 4.661887295765255
    susceptibility_parameters = [2.465821940646882, 3.1450483494498167, 1.8192730910303434, 4.979659886628877, 5.112704234744915, 3.019006335445148, 3.0213404468156053]
    temperature_parameters = [-0.9115305101700567, -0.1915605201733912, -0.062157385795265085, -0.6388596198732911, -0.6203734578192731, -0.9333177725908637, -0.2823407802600868]
    immune_memory_susceptibility_levels = [0.5916972324108036, 0.9376458819606536, 0.889296432144048, 0.7177392464154718, 0.8672890963654551, 0.7082360786928976, 0.9449816605535178]
    mean_immunity_durations = [284.0183394464822, 101.6375458486162, 183.53684561520507, 299.27409136378793, 83.28476158719573, 215.99833277759254, 42.22040680226742]
    random_infection_probabilities = [0.0016312104034678226, 0.0009616538846282095, 0.00046988996332110705, 5.226742247415806e-6]

    # 66
    duration_parameter = 4.669889963321107
    susceptibility_parameters = [3.3667889296432145, 5.899299766588863, 1.3851283761253752, 6.102367455818606, 6.0813604534844945, 5.803601200400133, 6.216738912970991]
    temperature_parameters = [-0.18891963987996008, -0.8187695898632877, -0.7893897965988663, -0.09714904968322768, -0.43221073691230416, -0.014951650550183437, -0.4744648216072024]
    immune_memory_susceptibility_levels = [0.8617872624208069, 0.5926975658552851, 0.8401133711237079, 0.7835945315105035, 0.6332110703567856, 0.515838612870957, 0.9083027675891964]
    mean_immunity_durations = [91.08469489829943, 261.88029343114374, 103.70223407802601, 149.92830943647883, 189.6162054018006, 235.38346115371792, 142.01367122374126]
    random_infection_probabilities = [0.0011907302434144716, 0.0007062354118039346, 0.00023021007002334114, 9.891630543514504e-6]

    # 67
    duration_parameter = 4.351783927975992
    susceptibility_parameters = [3.847615871957319, 6.205068356118706, 6.6648882960987, 7.274091363787929, 5.868956318772924, 7.117705901967322, 4.1837279093031015]
    temperature_parameters = [-0.31106035345115035, -0.2711170390130043, -0.4302300766922308, -0.9745815271757252, -0.5444481493831277, -0.2476792264088029, -0.1786862287429143]
    immune_memory_susceptibility_levels = [0.847782594198066, 0.7212404134711571, 0.9839946648882961, 0.9949983327775925, 0.5448482827609203, 0.9954984994998333, 0.6213737912637546]
    mean_immunity_durations = [78.35245081693898, 163.69289763254417, 171.378126042014, 191.79559853284428, 42.67922640880293, 324.3944648216072, 176.99866622207404]
    random_infection_probabilities = [0.0011053684561520506, 0.0008912970990330111, 0.00021940646882294098, 5.023341113704569e-6]

    # 68
    duration_parameter = 3.6665555185061685
    susceptibility_parameters = [3.952650883627876, 5.9109703234411475, 6.657885961987329, 6.902967655885295, 5.6332110703567855, 6.996332110703568, 7.899633211070356]
    temperature_parameters = [-0.0796532177392465, -0.06644881627209076, -0.6906868956318772, -0.8296632210736912, -0.8379159719906636, -0.8613537845948649, -0.8342847615871958]
    immune_memory_susceptibility_levels = [0.6947315771923974, 0.972490830276759, 0.9331443814604868, 0.6737245748582861, 0.7574191397132377, 0.6247082360786929, 0.5333444481493831]
    mean_immunity_durations = [72.84661553851284, 40.270423474491494, 139.03134378126043, 310.4004668222741, 222.53651217072357, 164.03701233744582, 178.1457152384128]
    random_infection_probabilities = [0.001308436145381794, 0.0005308436145381794, 0.0004366788929643215, 5.730243414471491e-6]

    # 69
    duration_parameter = 4.795931977325775
    susceptibility_parameters = [4.209403134378126, 4.174391463821274, 2.5801933977992664, 5.404468156052017, 4.389129709903301, 2.12270756918973, 3.8452817605868623]
    temperature_parameters = [-0.23810603534511499, -0.09186728909636555, -0.9953784594864955, -0.6543747915971991, -0.4071223741247082, -0.41603534511503837, -0.4936112037345781]
    immune_memory_susceptibility_levels = [0.9304768256085362, 0.796432144048016, 0.7994331443814605, 0.8019339779926642, 0.5261753917972658, 0.6183727909303101, 0.7247415805268422]
    mean_immunity_durations = [232.97465821940648, 154.40180060020006, 295.94764921640547, 159.10470156718907, 245.8216072024008, 266.00966988996333, 101.75225075025008]
    random_infection_probabilities = [0.001978326108702901, 0.0007620873624541514, 0.0004204734911637212, 5.110036678892965e-6]

    # 70
    duration_parameter = 3.9536512170723572
    susceptibility_parameters = [3.630543514504835, 5.2784261420473495, 2.146048682894298, 5.070690230076692, 4.0530176725575195, 1.8916305435145049, 3.163721240413471]
    temperature_parameters = [-0.9778826275425142, -0.6520640213404468, -0.3292164054684895, -0.9448716238746249, -0.12091697232410803, -0.5830710236745582, -0.5705268422807602]
    immune_memory_susceptibility_levels = [0.7814271423807936, 0.537512504168056, 0.9703234411470489, 0.764754918306102, 0.9893297765921973, 0.8726242080693565, 0.9581527175725242]
    mean_immunity_durations = [263.3714571523841, 208.3131043681227, 253.27742580860286, 350.4324774924975, 142.93131043681228, 91.08469489829943, 263.9449816605535]
    random_infection_probabilities = [0.0015165055018339446, 0.0006528842947649216, 0.00029673224408136045, 1.3126042014004667e-5]

    # CHANGE THE INDEX OF OUTPUT FILE!!!!!!!!!!
    surrogate_index = 70
    # ------------------------

    duration_parameter = 3.7208884
    susceptibility_parameters = [3.60367488861084, 4.7758259773254395, 1.5442054271697998, 4.042706489562988, 3.077371597290039, 3.4204025268554688, 3.1331827640533447]
    temperature_parameters = [-0.7385919094085693, -0.8168496489524841, -0.13755765557289124, -0.2612091898918152, -0.22924920916557312, -0.2423945814371109, -0.13344940543174744]
    immune_memory_susceptibility_levels = [0.7320742011070251, 0.6778073906898499, 0.892433226108551, 0.9269858002662659, 0.7774124145507812, 0.8221585154533386, 0.787509024143219]
    mean_immunity_durations = [153.3936767578125, 117.25450897216797, 178.3994598388672, 179.27105712890625, 229.07518005371094, 142.44207763671875, 181.32508850097656]
    random_infection_probabilities = [0.0013024280779063702, 0.0007512732991017401, 0.0003460852021817118, 9.996540029533207e-6]

    viruses = Virus[
        # FluA
        Virus(1.4, 0.67, 1, 7,  4.8, 2.04, 1, 28,  8.0, 3.4, 1, 28,  4.6, 3.5, 2.3,  0.38, 0.47, 0.57,  mean_immunity_durations[1], mean_immunity_durations[1] * 0.33),
        # FluB
        Virus(0.6, 0.19, 1, 7,  3.7, 3.0, 1, 28,  6.1, 4.8, 1, 28,  4.7, 3.5, 2.4,  0.38, 0.47, 0.57,  mean_immunity_durations[2], mean_immunity_durations[2] * 0.33),
        # RV
        Virus(1.9, 1.11, 1, 7,  10.1, 7.0, 1, 28,  11.4, 7.7, 1, 28,  3.5, 2.6, 1.8,  0.19, 0.24, 0.29,  mean_immunity_durations[3], mean_immunity_durations[3] * 0.33),
        # RSV
        Virus(4.4, 1.0, 1, 7,  6.5, 2.7, 1, 28,  6.7, 2.8, 1, 28,  6.0, 4.5, 3.0,  0.24, 0.3, 0.36,  mean_immunity_durations[4], mean_immunity_durations[4] * 0.33),
        # AdV
        Virus(5.6, 1.3, 1, 7,  8.0, 5.6, 1, 28,  9.0, 6.3, 1, 28,  4.1, 3.1, 2.1,  0.15, 0.19, 0.23,  mean_immunity_durations[5], mean_immunity_durations[5] * 0.33),
        # PIV
        Virus(2.6, 0.85, 1, 7,  7.0, 2.9, 1, 28,  8.0, 3.4, 1, 28,  4.8, 3.6, 2.4,  0.16, 0.2, 0.24,  mean_immunity_durations[6], mean_immunity_durations[6] * 0.33),
        # CoV
        Virus(3.2, 0.44, 1, 7,  6.5, 4.5, 1, 28,  7.5, 5.2, 1, 28,  4.9, 3.7, 2.5,  0.21, 0.26, 0.32,  mean_immunity_durations[7], mean_immunity_durations[7] * 0.33)]

    # Only FluA
    # viruses = Virus[
    #     # FluA
    #     Virus(1.4, 0.67, 1, 7,  4.8, 2.04, 1, 28,  8.0, 3.4, 1, 28,  4.6, 3.5, 2.3,  0.38, 0.47, 0.57,  mean_immunity_durations[1], mean_immunity_durations[1] * 0.33),
    #     # FluB
    #     Virus(0.6, 0.19, 1, 7,  3.7, 3.0, 1, 28,  6.1, 4.8, 1, 28,  0.0, 0.0, 0.0,  0.38, 0.47, 0.57,  mean_immunity_durations[2], mean_immunity_durations[2] * 0.33),
    #     # RV
    #     Virus(1.9, 1.11, 1, 7,  10.1, 7.0, 1, 28,  11.4, 7.7, 1, 28,  0.0, 0.0, 0.0,  0.19, 0.24, 0.29,  mean_immunity_durations[3], mean_immunity_durations[3] * 0.33),
    #     # RSV
    #     Virus(4.4, 1.0, 1, 7,  6.5, 2.7, 1, 28,  6.7, 2.8, 1, 28,  0.0, 0.0, 0.0,  0.24, 0.3, 0.36,  mean_immunity_durations[4], mean_immunity_durations[4] * 0.33),
    #     # AdV
    #     Virus(5.6, 1.3, 1, 7,  8.0, 5.6, 1, 28,  9.0, 6.3, 1, 28,  0.0, 0.0, 0.0,  0.15, 0.19, 0.23,  mean_immunity_durations[5], mean_immunity_durations[5] * 0.33),
    #     # PIV
    #     Virus(2.6, 0.85, 1, 7,  7.0, 2.9, 1, 28,  8.0, 3.4, 1, 28,  0.0, 0.0, 0.0,  0.16, 0.2, 0.24,  mean_immunity_durations[6], mean_immunity_durations[6] * 0.33),
    #     # CoV
    #     Virus(3.2, 0.44, 1, 7,  6.5, 4.5, 1, 28,  7.5, 5.2, 1, 28,  0.0, 0.0, 0.0,  0.21, 0.26, 0.32,  mean_immunity_durations[7], mean_immunity_durations[7] * 0.33)]

    # Replace CoV with COVID
    # viruses = Virus[
    #     # FluA
    #     Virus(1.4, 0.67, 1, 7,  4.8, 2.04, 1, 28,  8.0, 3.4, 1, 28,  4.6, 3.5, 2.3,  0.38, 0.47, 0.57,  mean_immunity_durations[1], mean_immunity_durations[1] * 0.33),
    #     # FluB
    #     Virus(0.6, 0.19, 1, 7,  3.7, 3.0, 1, 28,  6.1, 4.8, 1, 28,  4.7, 3.5, 2.4,  0.38, 0.47, 0.57,  mean_immunity_durations[2], mean_immunity_durations[2] * 0.33),
    #     # RV
    #     Virus(1.9, 1.11, 1, 7,  10.1, 7.0, 1, 28,  11.4, 7.7, 1, 28,  3.5, 2.6, 1.8,  0.19, 0.24, 0.29,  mean_immunity_durations[3], mean_immunity_durations[3] * 0.33),
    #     # RSV
    #     Virus(4.4, 1.0, 1, 7,  6.5, 2.7, 1, 28,  6.7, 2.8, 1, 28,  6.0, 4.5, 3.0,  0.24, 0.3, 0.36,  mean_immunity_durations[4], mean_immunity_durations[4] * 0.33),
    #     # AdV
    #     Virus(5.6, 1.3, 1, 7,  8.0, 5.6, 1, 28,  9.0, 6.3, 1, 28,  4.1, 3.1, 2.1,  0.15, 0.19, 0.23,  mean_immunity_durations[5], mean_immunity_durations[5] * 0.33),
    #     # PIV
    #     Virus(2.6, 0.85, 1, 7,  7.0, 2.9, 1, 28,  8.0, 3.4, 1, 28,  4.8, 3.6, 2.4,  0.16, 0.2, 0.24,  mean_immunity_durations[6], mean_immunity_durations[6] * 0.33),
    #     # CoV
    #     Virus(5.2, 3.7, 1, 10,  20.0, 5.2, 1, 35,  20.0, 5.2, 1, 35,  6.0, 6.0, 6.0,  0.1, 0.4, 0.8,  180.0, 180.0 * 0.33)]

    # Only COVID
    # viruses = Virus[
    #     # FluA
    #     Virus(1.4, 0.67, 1, 7,  4.8, 2.04, 1, 28,  8.0, 3.4, 1, 28,  0.0, 0.0, 0.0,  0.38, 0.47, 0.57,  mean_immunity_durations[1], mean_immunity_durations[1] * 0.33),
    #     # FluB
    #     Virus(0.6, 0.19, 1, 7,  3.7, 3.0, 1, 28,  6.1, 4.8, 1, 28,  0.0, 0.0, 0.0,  0.38, 0.47, 0.57,  mean_immunity_durations[2], mean_immunity_durations[2] * 0.33),
    #     # RV
    #     Virus(1.9, 1.11, 1, 7,  10.1, 7.0, 1, 28,  11.4, 7.7, 1, 28,  0.0, 0.0, 0.0,  0.19, 0.24, 0.29,  mean_immunity_durations[3], mean_immunity_durations[3] * 0.33),
    #     # RSV
    #     Virus(4.4, 1.0, 1, 7,  6.5, 2.7, 1, 28,  6.7, 2.8, 1, 28,  0.0, 0.0, 0.0,  0.24, 0.3, 0.36,  mean_immunity_durations[4], mean_immunity_durations[4] * 0.33),
    #     # AdV
    #     Virus(5.6, 1.3, 1, 7,  8.0, 5.6, 1, 28,  9.0, 6.3, 1, 28,  0.0, 0.0, 0.0,  0.15, 0.19, 0.23,  mean_immunity_durations[5], mean_immunity_durations[5] * 0.33),
    #     # PIV
    #     Virus(2.6, 0.85, 1, 7,  7.0, 2.9, 1, 28,  8.0, 3.4, 1, 28,  0.0, 0.0, 0.0,  0.16, 0.2, 0.24,  mean_immunity_durations[6], mean_immunity_durations[6] * 0.33),
    #     # CoV
    #     Virus(5.2, 3.7, 1, 10,  20.0, 5.2, 1, 35,  20.0, 5.2, 1, 35,  6.0, 6.0, 6.0,  0.1, 0.4, 0.8,  180.0, 180.0 * 0.33)]

    # Only COVID
    # viruses = Virus[
    #     # FluA
    #     Virus(1.4, 0.67, 1, 7,  4.8, 2.04, 1, 28,  8.0, 3.4, 1, 28,  0.0, 0.0, 0.0,  0.38, 0.47, 0.57,  mean_immunity_durations[1], mean_immunity_durations[1] * 0.33),
    #     # FluB
    #     Virus(0.6, 0.19, 1, 7,  3.7, 3.0, 1, 28,  6.1, 4.8, 1, 28,  0.0, 0.0, 0.0,  0.38, 0.47, 0.57,  mean_immunity_durations[2], mean_immunity_durations[2] * 0.33),
    #     # RV
    #     Virus(1.9, 1.11, 1, 7,  10.1, 7.0, 1, 28,  11.4, 7.7, 1, 28,  0.0, 0.0, 0.0,  0.19, 0.24, 0.29,  mean_immunity_durations[3], mean_immunity_durations[3] * 0.33),
    #     # RSV
    #     Virus(4.4, 1.0, 1, 7,  6.5, 2.7, 1, 28,  6.7, 2.8, 1, 28,  0.0, 0.0, 0.0,  0.24, 0.3, 0.36,  mean_immunity_durations[4], mean_immunity_durations[4] * 0.33),
    #     # AdV
    #     Virus(5.6, 1.3, 1, 7,  8.0, 5.6, 1, 28,  9.0, 6.3, 1, 28,  0.0, 0.0, 0.0,  0.15, 0.19, 0.23,  mean_immunity_durations[5], mean_immunity_durations[5] * 0.33),
    #     # PIV
    #     Virus(2.6, 0.85, 1, 7,  7.0, 2.9, 1, 28,  8.0, 3.4, 1, 28,  0.0, 0.0, 0.0,  0.16, 0.2, 0.24,  mean_immunity_durations[6], mean_immunity_durations[6] * 0.33),
    #     # CoV
    #     Virus(5.2, 3.7, 1, 10,  8.0, 2.0, 1, 35,  20.0, 5.2, 1, 35,  6.0, 6.0, 6.0,  0.1, 0.4, 0.8,  180.0, 180.0 * 0.33)]

    # Число домохозяйств каждого типа по районам
    district_households = get_district_households()
    # Число людей в каждой группе по районам
    district_people = get_district_people()
    # Число людей в домохозяйствах по районам
    district_people_households = get_district_people_households()
    # Распределение вирусов в течение года
    etiology = get_etiology()
    # Номера районов для MPI процессов
    district_nums = get_district_nums()
    # Температура воздуха, начиная с 1 января
    temperature = get_air_temperature(with_global_warming)

    agents = Array{Agent, 1}(undef, num_agents)

    # With seed
    thread_rng = [MersenneTwister(i + run_num * num_threads) for i = 1:num_threads]

    homes_coords_df = DataFrame(CSV.File(joinpath(@__DIR__, "..", "input", "tables", "space", "homes.csv")))
    # Массив для хранения домохозяйств
    households = Array{Household, 1}(undef, num_households)

    kindergarten_coords_df = DataFrame(CSV.File(joinpath(@__DIR__, "..", "input", "tables", "space", "kindergartens.csv")))
    # Массив для хранения детских садов
    kindergartens = Array{School, 1}(undef, num_kindergartens)
    for i in 1:size(kindergarten_coords_df, 1)
        kindergartens[i] = School(
            1,
            kindergarten_coords_df[i, :dist],
            kindergarten_coords_df[i, :x],
            kindergarten_coords_df[i, :y],
        )
    end

    school_coords_df = DataFrame(CSV.File(joinpath(@__DIR__, "..", "input", "tables", "space", "schools.csv")))
    # Массив для хранения школ
    schools = Array{School, 1}(undef, num_schools)
    for i in 1:size(school_coords_df, 1)
        schools[i] = School(
            2,
            school_coords_df[i, :dist],
            school_coords_df[i, :x],
            school_coords_df[i, :y],
        )
    end

    college_coords_df = DataFrame(CSV.File(joinpath(@__DIR__, "..", "input", "tables", "space", "colleges.csv")))
    # Массив для хранения институтов
    colleges = Array{School, 1}(undef, num_colleges)
    for i in 1:size(college_coords_df, 1)
        colleges[i] = School(
            3,
            college_coords_df[i, :dist],
            college_coords_df[i, :x],
            college_coords_df[i, :y],
        )
    end

    # Массив для хранения фирм
    workplaces = Workplace[]

    # shop_coords_df = DataFrame(CSV.File(joinpath(@__DIR__, "..", "input", "tables", "space", "shops.csv")))
    # # Массив для хранения продовольственных магазинов
    # shops = Array{PublicSpace, 1}(undef, num_shops)
    # for i in 1:size(shop_coords_df, 1)
    #     shops[i] = PublicSpace(
    #         shop_coords_df[i, :dist],
    #         shop_coords_df[i, :x],
    #         shop_coords_df[i, :y],
    #         ceil(Int, rand(Gamma(shop_capacity_shape, shop_capacity_scale))),
    #         shop_num_groups,
    #     )
    # end

    # restaurant_coords_df = DataFrame(CSV.File(joinpath(@__DIR__, "..", "input", "tables", "space", "restaurants.csv")))
    # # Массив для хранения ресторанов/кафе/столовых
    # restaurants = Array{PublicSpace, 1}(undef, num_restaurants)
    # for i in 1:size(restaurant_coords_df, 1)
    #     restaurants[i] = PublicSpace(
    #         restaurant_coords_df[i, :dist],
    #         restaurant_coords_df[i, :x],
    #         restaurant_coords_df[i, :y],
    #         restaurant_coords_df[i, :seats],
    #         restaurant_num_groups,
    #     )
    # end

    infected_data_0_all = readdlm(joinpath(@__DIR__, "..", "input", "tables", "flu0-2.csv"), ',', Int, '\n')
    infected_data_3_all = readdlm(joinpath(@__DIR__, "..", "input", "tables", "flu3-6.csv"), ',', Int, '\n')
    infected_data_7_all = readdlm(joinpath(@__DIR__, "..", "input", "tables", "flu7-14.csv"), ',', Int, '\n')
    infected_data_15_all = readdlm(joinpath(@__DIR__, "..", "input", "tables", "flu15+.csv"), ',', Int, '\n')

    infected_data_0 = infected_data_0_all[2:53, 24:26]
    infected_data_0_1 = etiology[:, 1] .* infected_data_0
    infected_data_0_2 = etiology[:, 2] .* infected_data_0
    infected_data_0_3 = etiology[:, 3] .* infected_data_0
    infected_data_0_4 = etiology[:, 4] .* infected_data_0
    infected_data_0_5 = etiology[:, 5] .* infected_data_0
    infected_data_0_6 = etiology[:, 6] .* infected_data_0
    infected_data_0_7 = etiology[:, 7] .* infected_data_0
    infected_data_0_viruses = cat(
        vec(infected_data_0_1),
        vec(infected_data_0_2),
        vec(infected_data_0_3),
        vec(infected_data_0_4),
        vec(infected_data_0_5),
        vec(infected_data_0_6),
        vec(infected_data_0_7),
        dims = 2)

    # infected_data_3 = infected_data_3[2:53, 21:27]
    infected_data_3 = infected_data_3_all[2:53, 24:26]
    infected_data_3_1 = etiology[:, 1] .* infected_data_3
    infected_data_3_2 = etiology[:, 2] .* infected_data_3
    infected_data_3_3 = etiology[:, 3] .* infected_data_3
    infected_data_3_4 = etiology[:, 4] .* infected_data_3
    infected_data_3_5 = etiology[:, 5] .* infected_data_3
    infected_data_3_6 = etiology[:, 6] .* infected_data_3
    infected_data_3_7 = etiology[:, 7] .* infected_data_3
    infected_data_3_viruses = cat(
        vec(infected_data_3_1),
        vec(infected_data_3_2),
        vec(infected_data_3_3),
        vec(infected_data_3_4),
        vec(infected_data_3_5),
        vec(infected_data_3_6),
        vec(infected_data_3_7),
        dims = 2)

    # infected_data_7 = infected_data_7[2:53, 21:27]
    infected_data_7 = infected_data_7_all[2:53, 24:26]
    infected_data_7_1 = etiology[:, 1] .* infected_data_7
    infected_data_7_2 = etiology[:, 2] .* infected_data_7
    infected_data_7_3 = etiology[:, 3] .* infected_data_7
    infected_data_7_4 = etiology[:, 4] .* infected_data_7
    infected_data_7_5 = etiology[:, 5] .* infected_data_7
    infected_data_7_6 = etiology[:, 6] .* infected_data_7
    infected_data_7_7 = etiology[:, 7] .* infected_data_7
    infected_data_7_viruses = cat(
        vec(infected_data_7_1),
        vec(infected_data_7_2),
        vec(infected_data_7_3),
        vec(infected_data_7_4),
        vec(infected_data_7_5),
        vec(infected_data_7_6),
        vec(infected_data_7_7),
        dims = 2)

    # infected_data_15 = infected_data_15[2:53, 21:27]
    infected_data_15 = infected_data_15_all[2:53, 24:26]
    infected_data_15_1 = etiology[:, 1] .* infected_data_15
    infected_data_15_2 = etiology[:, 2] .* infected_data_15
    infected_data_15_3 = etiology[:, 3] .* infected_data_15
    infected_data_15_4 = etiology[:, 4] .* infected_data_15
    infected_data_15_5 = etiology[:, 5] .* infected_data_15
    infected_data_15_6 = etiology[:, 6] .* infected_data_15
    infected_data_15_7 = etiology[:, 7] .* infected_data_15
    infected_data_15_viruses = cat(
        vec(infected_data_15_1),
        vec(infected_data_15_2),
        vec(infected_data_15_3),
        vec(infected_data_15_4),
        vec(infected_data_15_5),
        vec(infected_data_15_6),
        vec(infected_data_15_7),
        dims = 2)

    num_infected_age_groups_viruses = cat(
        infected_data_0_viruses,
        infected_data_3_viruses,
        infected_data_7_viruses,
        infected_data_15_viruses,
        dims = 3,
    )


    infected_data_0_prev = infected_data_0_all[2:53, 23]
    infected_data_0_1_prev = etiology[:, 1] .* infected_data_0_prev
    infected_data_0_2_prev = etiology[:, 2] .* infected_data_0_prev
    infected_data_0_3_prev = etiology[:, 3] .* infected_data_0_prev
    infected_data_0_4_prev = etiology[:, 4] .* infected_data_0_prev
    infected_data_0_5_prev = etiology[:, 5] .* infected_data_0_prev
    infected_data_0_6_prev = etiology[:, 6] .* infected_data_0_prev
    infected_data_0_7_prev = etiology[:, 7] .* infected_data_0_prev
    infected_data_0_viruses_prev = cat(
        vec(infected_data_0_1_prev),
        vec(infected_data_0_2_prev),
        vec(infected_data_0_3_prev),
        vec(infected_data_0_4_prev),
        vec(infected_data_0_5_prev),
        vec(infected_data_0_6_prev),
        vec(infected_data_0_7_prev),
        dims = 2)

    # infected_data_3 = infected_data_3[2:53, 21:27]
    infected_data_3_prev = infected_data_3_all[2:53, 23]
    infected_data_3_1_prev = etiology[:, 1] .* infected_data_3_prev
    infected_data_3_2_prev = etiology[:, 2] .* infected_data_3_prev
    infected_data_3_3_prev = etiology[:, 3] .* infected_data_3_prev
    infected_data_3_4_prev = etiology[:, 4] .* infected_data_3_prev
    infected_data_3_5_prev = etiology[:, 5] .* infected_data_3_prev
    infected_data_3_6_prev = etiology[:, 6] .* infected_data_3_prev
    infected_data_3_7_prev = etiology[:, 7] .* infected_data_3_prev
    infected_data_3_viruses_prev = cat(
        vec(infected_data_3_1_prev),
        vec(infected_data_3_2_prev),
        vec(infected_data_3_3_prev),
        vec(infected_data_3_4_prev),
        vec(infected_data_3_5_prev),
        vec(infected_data_3_6_prev),
        vec(infected_data_3_7_prev),
        dims = 2)

    # infected_data_7 = infected_data_7[2:53, 21:27]
    infected_data_7_prev = infected_data_7_all[2:53, 23]
    infected_data_7_1_prev = etiology[:, 1] .* infected_data_7_prev
    infected_data_7_2_prev = etiology[:, 2] .* infected_data_7_prev
    infected_data_7_3_prev = etiology[:, 3] .* infected_data_7_prev
    infected_data_7_4_prev = etiology[:, 4] .* infected_data_7_prev
    infected_data_7_5_prev = etiology[:, 5] .* infected_data_7_prev
    infected_data_7_6_prev = etiology[:, 6] .* infected_data_7_prev
    infected_data_7_7_prev = etiology[:, 7] .* infected_data_7_prev
    infected_data_7_viruses_prev = cat(
        vec(infected_data_7_1_prev),
        vec(infected_data_7_2_prev),
        vec(infected_data_7_3_prev),
        vec(infected_data_7_4_prev),
        vec(infected_data_7_5_prev),
        vec(infected_data_7_6_prev),
        vec(infected_data_7_7_prev),
        dims = 2)

    # infected_data_15 = infected_data_15[2:53, 21:27]
    infected_data_15_prev = infected_data_15_all[2:53, 23]
    infected_data_15_1_prev = etiology[:, 1] .* infected_data_15_prev
    infected_data_15_2_prev = etiology[:, 2] .* infected_data_15_prev
    infected_data_15_3_prev = etiology[:, 3] .* infected_data_15_prev
    infected_data_15_4_prev = etiology[:, 4] .* infected_data_15_prev
    infected_data_15_5_prev = etiology[:, 5] .* infected_data_15_prev
    infected_data_15_6_prev = etiology[:, 6] .* infected_data_15_prev
    infected_data_15_7_prev = etiology[:, 7] .* infected_data_15_prev
    infected_data_15_viruses_prev = cat(
        vec(infected_data_15_1_prev),
        vec(infected_data_15_2_prev),
        vec(infected_data_15_3_prev),
        vec(infected_data_15_4_prev),
        vec(infected_data_15_5_prev),
        vec(infected_data_15_6_prev),
        vec(infected_data_15_7_prev),
        dims = 2)

    num_all_infected_age_groups_viruses = cat(
        infected_data_0_viruses_prev,
        infected_data_3_viruses_prev,
        infected_data_7_viruses_prev,
        infected_data_15_viruses_prev,
        dims = 3,
    )

    for virus_id = 1:length(viruses)
        num_all_infected_age_groups_viruses[:, virus_id, 1] ./= viruses[virus_id].symptomatic_probability_child * (1 - (1 - isolation_probabilities_day_1[1]) * (1 - isolation_probabilities_day_2[1]) * (1 - isolation_probabilities_day_3[1]))
        num_all_infected_age_groups_viruses[:, virus_id, 2] ./= viruses[virus_id].symptomatic_probability_child * (1 - (1 - isolation_probabilities_day_1[2]) * (1 - isolation_probabilities_day_2[2]) * (1 - isolation_probabilities_day_3[2]))
        num_all_infected_age_groups_viruses[:, virus_id, 3] ./= viruses[virus_id].symptomatic_probability_teenager * (1 - (1 - isolation_probabilities_day_1[3]) * (1 - isolation_probabilities_day_2[3]) * (1 - isolation_probabilities_day_3[3]))
        num_all_infected_age_groups_viruses[:, virus_id, 4] ./= viruses[virus_id].symptomatic_probability_adult * (1 - (1 - isolation_probabilities_day_1[4]) * (1 - isolation_probabilities_day_2[4]) * (1 - isolation_probabilities_day_3[4]))
    end

    # println(num_all_infected_age_groups_viruses[17, 3, 4] / num_agents_age_groups[4])
    # return

    @time @threads for thread_id in 1:num_threads
        create_population(
            thread_id, num_threads, thread_rng, start_agent_ids[thread_id], end_agent_ids[thread_id],
            agents, households, viruses, num_all_infected_age_groups_viruses, isolation_probabilities_day_1,
            isolation_probabilities_day_2, isolation_probabilities_day_3, start_household_ids[thread_id],
            homes_coords_df, district_households, district_people, district_people_households, district_nums,
            immune_memory_susceptibility_levels[1], immune_memory_susceptibility_levels[2],
            immune_memory_susceptibility_levels[3], immune_memory_susceptibility_levels[4],
            immune_memory_susceptibility_levels[5], immune_memory_susceptibility_levels[6],
            immune_memory_susceptibility_levels[7])
    end

    @time set_connections(
        agents, households, kindergartens, schools, colleges,
        workplaces, thread_rng, num_threads, homes_coords_df,
        firm_min_size, firm_max_size, num_barabasi_albert_attachments)

    # get_stats(agents, schools, workplaces)
    # return
    # println()

    println("Simulation...")

    # duration_parameter_array = vec(readdlm(joinpath(@__DIR__, "..", "parameters", "tables", "duration_parameter_array.csv"), ',', Float64, '\n'))
    # duration_parameter = mean(duration_parameter_array[burnin:step:end])
    
    # susceptibility_parameter_1_array = vec(readdlm(joinpath(@__DIR__, "..", "parameters", "tables", "susceptibility_parameter_1_array.csv"), ',', Float64, '\n'))
    # susceptibility_parameter_2_array = vec(readdlm(joinpath(@__DIR__, "..", "parameters", "tables", "susceptibility_parameter_2_array.csv"), ',', Float64, '\n'))
    # susceptibility_parameter_3_array = vec(readdlm(joinpath(@__DIR__, "..", "parameters", "tables", "susceptibility_parameter_3_array.csv"), ',', Float64, '\n'))
    # susceptibility_parameter_4_array = vec(readdlm(joinpath(@__DIR__, "..", "parameters", "tables", "susceptibility_parameter_4_array.csv"), ',', Float64, '\n'))
    # susceptibility_parameter_5_array = vec(readdlm(joinpath(@__DIR__, "..", "parameters", "tables", "susceptibility_parameter_5_array.csv"), ',', Float64, '\n'))
    # susceptibility_parameter_6_array = vec(readdlm(joinpath(@__DIR__, "..", "parameters", "tables", "susceptibility_parameter_6_array.csv"), ',', Float64, '\n'))
    # susceptibility_parameter_7_array = vec(readdlm(joinpath(@__DIR__, "..", "parameters", "tables", "susceptibility_parameter_7_array.csv"), ',', Float64, '\n'))
    # susceptibility_parameters = [
    #     mean(susceptibility_parameter_1_array[burnin:step:end]),
    #     mean(susceptibility_parameter_2_array[burnin:step:end]),
    #     mean(susceptibility_parameter_3_array[burnin:step:end]),
    #     mean(susceptibility_parameter_4_array[burnin:step:end]),
    #     mean(susceptibility_parameter_5_array[burnin:step:end]),
    #     mean(susceptibility_parameter_6_array[burnin:step:end]),
    #     mean(susceptibility_parameter_7_array[burnin:step:end])
    # ]

    # temperature_parameter_1_array = vec(readdlm(joinpath(@__DIR__, "..", "parameters", "tables", "temperature_parameter_1_array.csv"), ',', Float64, '\n'))
    # temperature_parameter_2_array = vec(readdlm(joinpath(@__DIR__, "..", "parameters", "tables", "temperature_parameter_2_array.csv"), ',', Float64, '\n'))
    # temperature_parameter_3_array = vec(readdlm(joinpath(@__DIR__, "..", "parameters", "tables", "temperature_parameter_3_array.csv"), ',', Float64, '\n'))
    # temperature_parameter_4_array = vec(readdlm(joinpath(@__DIR__, "..", "parameters", "tables", "temperature_parameter_4_array.csv"), ',', Float64, '\n'))
    # temperature_parameter_5_array = vec(readdlm(joinpath(@__DIR__, "..", "parameters", "tables", "temperature_parameter_5_array.csv"), ',', Float64, '\n'))
    # temperature_parameter_6_array = vec(readdlm(joinpath(@__DIR__, "..", "parameters", "tables", "temperature_parameter_6_array.csv"), ',', Float64, '\n'))
    # temperature_parameter_7_array = vec(readdlm(joinpath(@__DIR__, "..", "parameters", "tables", "temperature_parameter_7_array.csv"), ',', Float64, '\n'))
    # temperature_parameters = -[
    #     mean(temperature_parameter_1_array[burnin:step:end]),
    #     mean(temperature_parameter_2_array[burnin:step:end]),
    #     mean(temperature_parameter_3_array[burnin:step:end]),
    #     mean(temperature_parameter_4_array[burnin:step:end]),
    #     mean(temperature_parameter_5_array[burnin:step:end]),
    #     mean(temperature_parameter_6_array[burnin:step:end]),
    #     mean(temperature_parameter_7_array[burnin:step:end])
    # ]

    # duration_parameter = rand(duration_parameter_array[burnin:step:end])

    # susceptibility_parameters = [
    #     rand(susceptibility_parameter_1_array[burnin:step:end]),
    #     rand(susceptibility_parameter_2_array[burnin:step:end]),
    #     rand(susceptibility_parameter_3_array[burnin:step:end]),
    #     rand(susceptibility_parameter_4_array[burnin:step:end]),
    #     rand(susceptibility_parameter_5_array[burnin:step:end]),
    #     rand(susceptibility_parameter_6_array[burnin:step:end]),
    #     rand(susceptibility_parameter_7_array[burnin:step:end])
    # ]

    # temperature_parameters = -[
    #     rand(temperature_parameter_1_array[burnin:step:end]),
    #     rand(temperature_parameter_2_array[burnin:step:end]),
    #     rand(temperature_parameter_3_array[burnin:step:end]),
    #     rand(temperature_parameter_4_array[burnin:step:end]),
    #     rand(temperature_parameter_5_array[burnin:step:end]),
    #     rand(temperature_parameter_6_array[burnin:step:end]),
    #     rand(temperature_parameter_7_array[burnin:step:end])
    # ]

    # @time @threads for thread_id = 1:num_threads
    #     for agent_id = start_agent_ids[thread_id]:end_agent_ids[thread_id]
    #         agent = agents[agent_id]
    #         if agent.age > 18
    #             agent.FluA_immunity_susceptibility_level = immune_memory_susceptibility_levels[1]
    #             agent.FluB_immunity_susceptibility_level = immune_memory_susceptibility_levels[2]
    #             agent.RV_immunity_susceptibility_level = immune_memory_susceptibility_levels[3]
    #             agent.RSV_immunity_susceptibility_level = immune_memory_susceptibility_levels[4]
    #             agent.AdV_immunity_susceptibility_level = immune_memory_susceptibility_levels[5]
    #             agent.PIV_immunity_susceptibility_level = immune_memory_susceptibility_levels[6]
    #             agent.CoV_immunity_susceptibility_level = immune_memory_susceptibility_levels[7]
    #         end
    #     end
    # end

    @time observed_num_infected_age_groups_viruses, num_infected_age_groups_viruses, activities_infections, rt, num_schools_closed = run_simulation(
        num_threads, thread_rng, agents, viruses, households, schools, duration_parameter,
        susceptibility_parameters, temperature_parameters, temperature,
        mean_household_contact_durations, household_contact_duration_sds,
        other_contact_duration_shapes, other_contact_duration_scales,
        isolation_probabilities_day_1, isolation_probabilities_day_2,
        isolation_probabilities_day_3, random_infection_probabilities,
        recovered_duration_mean, recovered_duration_sd, num_years, is_rt_run,
        immune_memory_susceptibility_levels[1], immune_memory_susceptibility_levels[2],
        immune_memory_susceptibility_levels[3], immune_memory_susceptibility_levels[4],
        immune_memory_susceptibility_levels[5], immune_memory_susceptibility_levels[6],
        immune_memory_susceptibility_levels[7], school_class_closure_period, school_class_closure_threshold)

    # for k = 1:7
    #     println("Virus: $(k)")
    #     age_dist = sum(num_infected_age_groups_viruses[:, k, :], dims = 1)[1, :]
    #     println(age_dist ./ sum(age_dist))
    # end

    if with_global_warming
        save(joinpath(@__DIR__, "..", "output", "tables", "results_warming_$(run_num + 1).jld"),
            "observed_cases", observed_num_infected_age_groups_viruses,
            "all_cases", num_infected_age_groups_viruses,
            "activities_cases", activities_infections,
            "rt", rt)
    elseif school_class_closure_period == 0
        save(joinpath(@__DIR__, "..", "output", "tables", "results_$(run_num + 1).jld"),
            "observed_cases", observed_num_infected_age_groups_viruses,
            "all_cases", num_infected_age_groups_viruses,
            "activities_cases", activities_infections,
            "rt", rt)
    elseif school_class_closure_threshold > 0.99
        save(joinpath(@__DIR__, "..", "output", "tables", "results_class_quarantine_$(run_num + 1).jld"),
            "observed_cases", observed_num_infected_age_groups_viruses,
            "all_cases", num_infected_age_groups_viruses,
            "activities_cases", activities_infections,
            "rt", rt,
            "num_schools_closed", num_schools_closed)
    else
        save(joinpath(@__DIR__, "..", "output", "tables", "results_quarantine_$(run_num + 1).jld"),
            "observed_cases", observed_num_infected_age_groups_viruses,
            "all_cases", num_infected_age_groups_viruses,
            "activities_cases", activities_infections,
            "rt", rt,
            "num_schools_closed", num_schools_closed)
    end


    # !!!!!!!!!!!!!!!!!!!!!!!!
    # Surrogate model training
    save(joinpath(@__DIR__, "..", "parameters_labels", "3", "tables", "results_$(surrogate_index).jld"),
        "observed_cases", observed_num_infected_age_groups_viruses,
        "duration_parameter", duration_parameter,
        "susceptibility_parameters", susceptibility_parameters,
        "temperature_parameters", temperature_parameters,
        "random_infection_probabilities", random_infection_probabilities,
        "immune_memory_susceptibility_levels", immune_memory_susceptibility_levels,
        "mean_immunity_durations", [viruses[1].mean_immunity_duration, viruses[2].mean_immunity_duration, viruses[3].mean_immunity_duration, viruses[4].mean_immunity_duration, viruses[5].mean_immunity_duration, viruses[6].mean_immunity_duration, viruses[7].mean_immunity_duration])
    # !!!!!!!!!!!!!!!!!!!!!!!!




    # incidence_arr_mean = sum(sum(observed_num_infected_age_groups_viruses, dims = 3)[:, :, 1], dims = 2)[:, 1]

    # infected_data = readdlm(joinpath(@__DIR__, "..", "input", "tables", "flu.csv"), ',', Int, '\n')
    # infected_data_mean = vec(transpose(infected_data[42:44, 2:53]))

    # nMAE_general = sum(abs.(incidence_arr_mean - infected_data_mean)) / sum(infected_data_mean)
    # println("General nMAE: $(nMAE_general)")

    # # ------------------
    # incidence_arr_mean = sum(observed_num_infected_age_groups_viruses, dims = 2)[:, 1, :]

    # infected_data_0 = readdlm(joinpath(@__DIR__, "..", "input", "tables", "flu0-2.csv"), ',', Int, '\n')
    # infected_data_3 = readdlm(joinpath(@__DIR__, "..", "input", "tables", "flu3-6.csv"), ',', Int, '\n')
    # infected_data_7 = readdlm(joinpath(@__DIR__, "..", "input", "tables", "flu7-14.csv"), ',', Int, '\n')
    # infected_data_15 = readdlm(joinpath(@__DIR__, "..", "input", "tables", "flu15+.csv"), ',', Int, '\n')

    # infected_data_mean = cat(
    #     vec(infected_data_0[2:53, 24:26]),
    #     vec(infected_data_3[2:53, 24:26]),
    #     vec(infected_data_7[2:53, 24:26]),
    #     vec(infected_data_15[2:53, 24:26]),
    #     dims = 2,
    # )

    # nMAE_0_2 = sum(abs.(incidence_arr_mean[:, 1] - infected_data_mean[:, 1])) / sum(infected_data_mean[:, 1])
    # println("0-2 nMAE: $(nMAE_0_2)")

    # nMAE_3_6 = sum(abs.(incidence_arr_mean[:, 2] - infected_data_mean[:, 2])) / sum(infected_data_mean[:, 2])
    # println("3-6 nMAE: $(nMAE_3_6)")

    # nMAE_7_14 = sum(abs.(incidence_arr_mean[:, 3] - infected_data_mean[:, 3])) / sum(infected_data_mean[:, 3])
    # println("7-14 nMAE: $(nMAE_7_14)")

    # nMAE_15 = sum(abs.(incidence_arr_mean[:, 4] - infected_data_mean[:, 4])) / sum(infected_data_mean[:, 4])
    # println("15+ nMAE: $(nMAE_15)")

    # # ------------------

    # incidence_arr_mean = sum(observed_num_infected_age_groups_viruses, dims = 3)[:, :, 1]

    # infected_data = readdlm(joinpath(@__DIR__, "..", "input", "tables", "flu.csv"), ',', Int, '\n')
    # infected_data = transpose(infected_data[42:44, 2:53])

    # etiology = get_etiology()

    # infected_data_1 = etiology[:, 1] .* infected_data
    # infected_data_2 = etiology[:, 2] .* infected_data
    # infected_data_3 = etiology[:, 3] .* infected_data
    # infected_data_4 = etiology[:, 4] .* infected_data
    # infected_data_5 = etiology[:, 5] .* infected_data
    # infected_data_6 = etiology[:, 6] .* infected_data
    # infected_data_7 = etiology[:, 7] .* infected_data
    # infected_data_viruses_mean = cat(
    #     vec(infected_data_1),
    #     vec(infected_data_2),
    #     vec(infected_data_3),
    #     vec(infected_data_4),
    #     vec(infected_data_5),
    #     vec(infected_data_6),
    #     vec(infected_data_7),
    #     dims = 2)

    # nMAE_FluA = sum(abs.(incidence_arr_mean[:, 1] - infected_data_viruses_mean[:, 1])) / sum(infected_data_viruses_mean[:, 1])
    # println("FluA nMAE: $(nMAE_FluA)")

    # nMAE_FluB = sum(abs.(incidence_arr_mean[:, 2] - infected_data_viruses_mean[:, 2])) / sum(infected_data_viruses_mean[:, 2])
    # println("FluB nMAE: $(nMAE_FluB)")

    # nMAE_RV = sum(abs.(incidence_arr_mean[:, 3] - infected_data_viruses_mean[:, 3])) / sum(infected_data_viruses_mean[:, 3])
    # println("RV nMAE: $(nMAE_RV)")

    # nMAE_RSV = sum(abs.(incidence_arr_mean[:, 4] - infected_data_viruses_mean[:, 4])) / sum(infected_data_viruses_mean[:, 4])
    # println("RSV nMAE: $(nMAE_RSV)")

    # nMAE_AdV = sum(abs.(incidence_arr_mean[:, 5] - infected_data_viruses_mean[:, 5])) / sum(infected_data_viruses_mean[:, 5])
    # println("AdV nMAE: $(nMAE_AdV)")

    # nMAE_PIV = sum(abs.(incidence_arr_mean[:, 6] - infected_data_viruses_mean[:, 6])) / sum(infected_data_viruses_mean[:, 6])
    # println("PIV nMAE: $(nMAE_PIV)")

    # nMAE_CoV = sum(abs.(incidence_arr_mean[:, 7] - infected_data_viruses_mean[:, 7])) / sum(infected_data_viruses_mean[:, 7])
    # println("CoV nMAE: $(nMAE_CoV)")

    # averaged_nMAE = nMAE_FluA + nMAE_FluB + nMAE_RV + nMAE_RSV + nMAE_AdV + nMAE_PIV + nMAE_CoV + nMAE_general + nMAE_0_2 + nMAE_3_6 + nMAE_7_14 + nMAE_15
    # println("Averaged nMAE: $(averaged_nMAE / 12)")


    # observed_num_infected_age_groups_viruses_mean = zeros(Float64, 52, 7, 4)
    # for i = 1:num_years
    #     for j = 1:52
    #         for k = 1:7
    #             for z = 1:4
    #                 observed_num_infected_age_groups_viruses_mean[j, k, z] += observed_num_infected_age_groups_viruses[52 * (i - 1) + j, k, z]
    #             end
    #         end
    #     end
    # end
    # for j = 1:52
    #     for k = 1:7
    #         for z = 1:4
    #             observed_num_infected_age_groups_viruses_mean[j, k, z] /= num_years
    #         end
    #     end
    # end

    # MAE = sum(abs.(observed_num_infected_age_groups_viruses - num_infected_age_groups_viruses)) / (size(observed_num_infected_age_groups_viruses)[1] * size(observed_num_infected_age_groups_viruses)[2] * size(observed_num_infected_age_groups_viruses)[3])
    # RMSE = sqrt(sum((observed_num_infected_age_groups_viruses - num_infected_age_groups_viruses).^2)) / sqrt((size(observed_num_infected_age_groups_viruses)[1] * size(observed_num_infected_age_groups_viruses)[2] * size(observed_num_infected_age_groups_viruses)[3]))
    # nMAE = sum(abs.(observed_num_infected_age_groups_viruses - num_infected_age_groups_viruses)) / sum(num_infected_age_groups_viruses)
    # S_square = sum((observed_num_infected_age_groups_viruses - num_infected_age_groups_viruses).^2)

    # println("MAE: ", MAE)
    # println("RMSE: ", RMSE)
    # println("nMAE: ", nMAE)
    # println("S_square: ", S_square)
end

main()
