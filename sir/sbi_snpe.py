import torch
import numpy as np
import sbi.utils as utils
from sbi.inference.base import infer
import pandas as pd
import os
from matplotlib import pyplot as plt
import seaborn as sns

from sbi.inference import SNPE

# determine the supported device
def get_device():
    if torch.cuda.is_available():
        device = torch.device('cuda:0')
    else:
        device = torch.device('cpu') # don't have GPU 
    return device

# convert a df to tensor to be used in pytorch
def df_to_tensor(df):
    device = get_device()
    return torch.from_numpy(df.values).float().to(device)

prior = utils.BoxUniform(
    low=torch.tensor([0.02, 5.0, 0.01, 1.0]),
    high=torch.tensor([0.2, 25, 0.05, 50.0])
)

#SNPE or SNLE or SNRE
inference = SNPE(prior=prior)

num_initial_runs = 1000

dirname = os.path.dirname(__file__)
filename = os.path.join(dirname, 'lhs_params.csv')
X = df_to_tensor(pd.read_csv(filename, index_col=False, header=None))

dirname = os.path.dirname(__file__)
filename = os.path.join(dirname, 'lhs_y.csv')
y = df_to_tensor(pd.read_csv(filename, index_col=False, header=None))

_ = inference.append_simulations(X, y).train()
posterior = inference.build_posterior()

n_samples = 1000
# S_ref = [99975, 99971, 99971, 99969, 99968, 99966, 99964, 99961, 99959, 99953, 99951, 99951, 99948, 99946, 99946, 99946, 99942, 99939, 99937, 99934, 99934, 99931, 99930, 99928, 99924, 99924, 99923, 99914, 99911, 99906, 99904, 99901, 99899, 99895, 99893, 99886, 99883, 99878, 99875, 99868, 99865, 99861, 99854, 99851, 99844, 99839, 99833, 99828, 99822, 99819, 99816, 99811, 99803, 99790, 99785, 99774, 99765, 99756, 99744, 99737, 99726, 99719, 99711, 99700, 99688, 99680, 99672, 99653, 99641, 99628, 99618, 99607, 99591, 99583, 99569, 99561, 99550, 99533, 99517, 99496, 99484, 99469, 99456, 99431, 99412, 99395, 99380, 99357, 99333, 99307, 99289, 99261, 99238, 99219, 99200, 99182, 99163, 99137, 99115, 99096, 99072, 99046, 99015, 98980, 98951, 98916, 98887, 98849, 98808, 98784, 98742, 98705, 98659, 98622, 98578, 98530, 98493, 98455, 98409, 98367, 98314, 98262, 98215, 98169, 98114, 98037, 97970, 97918, 97848, 97782, 97706, 97642, 97584, 97521, 97451, 97386, 97311, 97239, 97140, 97051, 96954, 96868, 96777, 96701, 96611, 96501, 96381, 96260, 96158, 96051, 95924, 95806, 95698, 95579, 95443, 95321, 95178, 95054, 94921, 94781, 94632, 94483, 94329, 94154, 93997, 93837, 93662, 93489, 93296, 93113, 92915, 92729, 92541, 92310, 92095, 91872, 91630, 91387, 91138, 90908, 90635, 90356, 90096, 89814, 89568, 89303, 88994, 88689, 88395, 88095, 87804, 87482, 87167, 86871, 86553, 86208, 85865, 85524, 85123, 84770, 84422, 84058, 83683, 83289, 82879, 82497, 82071, 81629, 81195, 80754, 80297, 79878, 79417, 78971, 78519, 78056, 77553, 77060, 76556, 76050, 75497, 74986, 74485, 73936, 73403, 72890, 72346, 71828, 71251, 70722, 70145, 69577, 69058, 68518, 67983, 67400, 66815, 66236, 65684, 65124, 64519, 63971, 63375, 62801, 62240, 61631, 61030, 60439, 59833, 59253, 58707, 58102, 57540, 56989, 56409, 55808, 55237, 54659, 54043, 53449, 52908, 52332, 51752, 51172, 50633, 50055, 49531, 48941, 48411, 47834, 47255, 46722, 46201, 45633, 45157, 44667, 44126, 43616, 43122, 42581, 42083, 41570, 41133, 40633, 40152, 39646, 39193, 38695, 38245, 37765, 37309, 36870, 36449, 36005, 35574, 35185, 34791, 34399, 33986, 33571, 33200, 32821, 32420, 32037, 31658, 31357, 31005, 30639, 30289, 29980, 29659, 29344, 29002, 28716, 28381, 28065, 27789, 27493, 27205, 26908, 26644, 26378, 26100, 25804, 25554, 25330, 25054, 24799, 24531, 24297, 24086, 23853, 23595, 23369, 23145, 22897, 22693, 22482, 22271, 22083, 21844, 21626, 21449, 21250, 21065, 20884, 20699, 20534, 20344, 20184, 20023, 19876, 19716, 19557, 19419, 19259, 19119, 18996, 18875, 18729, 18595, 18459, 18307, 18161, 18040, 17898, 17762, 17637, 17520, 17416, 17289, 17183, 17057, 16942, 16838, 16740, 16628, 16529, 16423, 16320, 16220, 16130, 16031, 15955, 15852, 15773, 15683, 15600, 15514, 15447, 15357, 15271, 15195, 15124, 15045, 14964, 14892, 14813, 14742, 14684, 14626, 25, 25, 25, 26, 25, 27, 29, 32, 34, 40, 41, 41, 43, 45, 44, 43, 44, 45, 44, 46, 46, 48, 49, 49, 51, 51, 51, 60, 62, 67, 68, 69, 70, 73, 72, 78, 81, 86, 86, 92, 91, 95, 102, 104, 108, 111, 117, 120, 125, 125, 125, 129, 135, 147, 149, 157, 160, 162, 173, 175, 182, 185, 191, 199, 205, 210, 212, 231, 239, 243, 246, 247, 259, 258, 267, 271, 274, 282, 293, 309, 316, 325, 335, 354, 361, 369, 375, 390, 405, 422, 431, 448, 465, 471, 479, 484, 490, 509, 524, 532, 546, 567, 584, 604, 623, 651, 668, 698, 725, 731, 760, 778, 808, 822, 858, 894, 917, 936, 970, 982, 1014, 1045, 1073, 1109, 1146, 1196, 1236, 1264, 1315, 1355, 1412, 1446, 1474, 1507, 1554, 1588, 1631, 1666, 1739, 1793, 1858, 1905, 1963, 2003, 2053, 2121, 2197, 2272, 2332, 2388, 2467, 2537, 2595, 2660, 2751, 2817, 2895, 2954, 3036, 3114, 3194, 3268, 3369, 3481, 3575, 3661, 3771, 3855, 3966, 4060, 4173, 4268, 4375, 4524, 4641, 4782, 4944, 5086, 5247, 5375, 5547, 5715, 5858, 6030, 6135, 6299, 6477, 6651, 6827, 6988, 7148, 7328, 7488, 7635, 7799, 8003, 8200, 8385, 8609, 8785, 8956, 9152, 9348, 9545, 9771, 9944, 10179, 10423, 10657, 10879, 11142, 11323, 11554, 11776, 12008, 12207, 12455, 12695, 12930, 13156, 13435, 13662, 13890, 14156, 14402, 14637, 14888, 15118, 15384, 15618, 15851, 16122, 16324, 16554, 16742, 17014, 17244, 17445, 17666, 17883, 18122, 18280, 18507, 18697, 18899, 19162, 19392, 19609, 19786, 19951, 20119, 20310, 20459, 20633, 20804, 20999, 21152, 21299, 21497, 21669, 21805, 21930, 22068, 22210, 22314, 22440, 22520, 22624, 22697, 22881, 22951, 23009, 23082, 23217, 23203, 23246, 23313, 23385, 23426, 23531, 23530, 23577, 23554, 23570, 23580, 23636, 23629, 23639, 23615, 23607, 23615, 23604, 23531, 23486, 23437, 23394, 23292, 23231, 23196, 23129, 22998, 22917, 22832, 22771, 22680, 22571, 22457, 22366, 22282, 22133, 22026, 21919, 21849, 21697, 21554, 21442, 21294, 21209, 21086, 20963, 20819, 20673, 20547, 20458, 20299, 20102, 20007, 19870, 19714, 19521, 19352, 19187, 19034, 18856, 18691, 18601, 18408, 18246, 18097, 17940, 17794, 17665, 17499, 17335, 17197, 17039, 16876, 16710, 16578, 16406, 16253, 16061, 15874, 15710, 15557, 15377, 15239, 15071, 14904, 14796, 14639, 14489, 14339, 14208, 14051, 13902, 13795, 13638, 13493, 13337, 13214, 13038, 12895, 12779, 12651, 12493, 12361, 12201, 12089, 11957, 11821, 11675, 11545, 11382, 11251, 11090, 10979, 10835, 10703, 10546, 10428, 10285, 10166, 10035, 9909, 9785, 9661, 9547, 9429, 9281, 9146, 0, 4, 4, 5, 7, 7, 7, 7, 7, 7, 8, 8, 9, 9, 10, 11, 14, 16, 19, 20, 20, 21, 21, 23, 25, 25, 26, 26, 27, 27, 28, 30, 31, 32, 35, 36, 36, 36, 39, 40, 44, 44, 44, 45, 48, 50, 50, 52, 53, 56, 59, 60, 62, 63, 66, 69, 75, 82, 83, 88, 92, 96, 98, 101, 107, 110, 116, 116, 120, 129, 136, 146, 150, 159, 164, 168, 176, 185, 190, 195, 200, 206, 209, 215, 227, 236, 245, 253, 262, 271, 280, 291, 297, 310, 321, 334, 347, 354, 361, 372, 382, 387, 401, 416, 426, 433, 445, 453, 467, 485, 498, 517, 533, 556, 564, 576, 590, 609, 621, 651, 672, 693, 712, 722, 740, 767, 794, 818, 837, 863, 882, 912, 942, 972, 995, 1026, 1058, 1095, 1121, 1156, 1188, 1227, 1260, 1296, 1336, 1378, 1422, 1468, 1510, 1561, 1609, 1657, 1707, 1761, 1806, 1862, 1927, 1992, 2043, 2105, 2174, 2249, 2302, 2365, 2428, 2502, 2567, 2656, 2738, 2827, 2912, 3003, 3084, 3166, 3264, 3346, 3426, 3527, 3615, 3717, 3818, 3929, 4046, 4156, 4297, 4398, 4529, 4660, 4778, 4917, 5048, 5190, 5345, 5494, 5648, 5789, 5935, 6091, 6268, 6445, 6622, 6790, 6969, 7166, 7350, 7559, 7750, 7948, 8148, 8367, 8561, 8799, 9029, 9253, 9473, 9737, 9992, 10245, 10514, 10794, 11068, 11352, 11625, 11908, 12195, 12473, 12766, 13054, 13365, 13660, 14004, 14301, 14618, 14928, 15275, 15586, 15941, 16319, 16650, 16993, 17359, 17749, 18118, 18502, 18861, 19207, 19578, 19952, 20381, 20796, 21174, 21588, 22001, 22378, 22787, 23193, 23611, 24042, 24460, 24882, 25287, 25738, 26180, 26618, 27053, 27505, 27949, 28435, 28892, 29285, 29794, 30269, 30717, 31150, 31640, 32087, 32561, 32999, 33452, 33888, 34387, 34853, 35313, 35797, 36268, 36718, 37178, 37666, 38140, 38628, 39076, 39526, 40020, 40509, 40989, 41421, 41917, 42370, 42818, 43300, 43802, 44262, 44748, 45192, 45662, 46072, 46538, 46995, 47429, 47887, 48315, 48737, 49149, 49587, 50065, 50493, 50917, 51298, 51709, 52129, 52537, 52949, 53353, 53738, 54147, 54568, 54939, 55331, 55755, 56182, 56562, 56960, 57371, 57775, 58164, 58502, 58899, 59272, 59632, 59977, 60362, 60709, 61052, 61415, 61738, 62077, 62425, 62756, 63078, 63410, 63724, 64063, 64410, 64733, 65024, 65364, 65642, 65933, 66221, 66475, 66766, 67052, 67354, 67631, 67909, 68200, 68443, 68725, 68987, 69247, 69497, 69779, 70048, 70279, 70511, 70767, 71011, 71270, 71488, 71723, 71959, 72195, 72424, 72663, 72897, 73137, 73338, 73565, 73783, 74007, 74215, 74444, 74639, 74841, 75046, 75251, 75447, 75640, 75829, 76035, 76228]
S_ref = [99975, 99971, 99971, 99969, 99968, 99966, 99964, 99961, 99959, 99953, 99951, 99951, 99948, 99946, 99946, 99946, 99942, 99939, 99937, 99934, 99934, 99931, 99930, 99928, 99924, 99924, 99923, 99914, 99911, 99906, 99904, 99901, 99899, 99895, 99893, 99886, 99883, 99878, 99875, 99868, 99865, 99861, 99854, 99851, 99844, 99839, 99833, 99828, 99822, 99819, 99816, 99811, 99803, 99790, 99785, 99774, 99765, 99756, 99744, 99737, 99726, 99719, 99711, 99700, 99688, 99680, 99672, 99653, 99641, 99628, 99618, 99607, 99591, 99583, 99569, 99561, 99550, 99533, 99517, 99496, 99484, 99469, 99456, 99431, 99412, 99395, 99380, 99357, 99333, 99307, 99289, 99261, 99238, 99219, 99200, 99182, 99163, 99137, 99115, 99096, 99072, 99046, 99015, 98980, 98951, 98916, 98887, 98849, 98808, 98784, 98742, 98705, 98659, 98622, 98578, 98530, 98493, 98455, 98409, 98367, 98314, 98262, 98215, 98169, 98114, 98037, 97970, 97918, 97848, 97782, 97706, 97642, 97584, 97521, 97451, 97386, 97311, 97239, 97140, 97051, 96954, 96868, 96777, 96701, 96611, 96501, 96381, 96260, 96158, 96051, 95924, 95806, 95698, 95579, 95443, 95321, 95178, 95054, 94921, 94781, 94632, 94483, 94329, 94154, 93997, 93837, 93662, 93489, 93296, 93113, 92915, 92729, 92541, 92310, 92095, 91872, 91630, 91387, 91138, 90908, 90635, 90356, 90096, 89814, 89568, 89303, 88994, 88689, 88395, 88095, 87804, 87482, 87167, 86871, 86553, 86208, 85865, 85524, 85123, 84770, 84422, 84058, 83683, 83289, 82879, 82497, 82071, 81629, 81195, 80754, 80297, 79878, 79417, 78971, 78519, 78056, 77553, 77060, 76556, 76050, 75497, 74986, 74485, 73936, 73403, 72890, 72346, 71828, 71251, 70722, 70145, 69577, 69058, 68518, 67983, 67400, 66815, 66236, 65684, 65124, 64519, 63971, 63375, 62801, 62240, 61631, 61030, 60439, 59833, 59253, 58707, 58102, 57540, 56989, 56409, 55808, 55237, 54659, 54043, 53449, 52908, 52332, 51752, 51172, 50633, 50055, 49531, 48941, 48411, 47834, 47255, 46722, 46201, 45633, 45157, 44667, 44126, 43616, 43122, 42581, 42083, 41570, 41133, 40633, 40152, 39646, 39193, 38695, 38245, 37765, 37309, 36870, 36449, 36005, 35574, 35185, 34791, 34399, 33986, 33571, 33200, 32821, 32420, 32037, 31658, 31357, 31005, 30639, 30289, 29980, 29659, 29344, 29002, 28716, 28381, 28065, 27789, 27493, 27205, 26908, 26644, 26378, 26100, 25804, 25554, 25330, 25054, 24799, 24531, 24297, 24086, 23853, 23595, 23369, 23145, 22897, 22693, 22482, 22271, 22083, 21844, 21626, 21449, 21250, 21065, 20884, 20699, 20534, 20344, 20184, 20023, 19876, 19716, 19557, 19419, 19259, 19119, 18996, 18875, 18729, 18595, 18459, 18307, 18161, 18040, 17898, 17762, 17637, 17520, 17416, 17289, 17183, 17057, 16942, 16838, 16740, 16628, 16529, 16423, 16320, 16220, 16130, 16031, 15955, 15852, 15773, 15683, 15600, 15514, 15447, 15357, 15271, 15195, 15124, 15045, 14964, 14892, 14813, 14742, 14684, 25, 25, 25, 26, 25, 27, 29, 32, 34, 40, 41, 41, 43, 45, 44, 43, 44, 45, 44, 46, 46, 48, 49, 49, 51, 51, 51, 60, 62, 67, 68, 69, 70, 73, 72, 78, 81, 86, 86, 92, 91, 95, 102, 104, 108, 111, 117, 120, 125, 125, 125, 129, 135, 147, 149, 157, 160, 162, 173, 175, 182, 185, 191, 199, 205, 210, 212, 231, 239, 243, 246, 247, 259, 258, 267, 271, 274, 282, 293, 309, 316, 325, 335, 354, 361, 369, 375, 390, 405, 422, 431, 448, 465, 471, 479, 484, 490, 509, 524, 532, 546, 567, 584, 604, 623, 651, 668, 698, 725, 731, 760, 778, 808, 822, 858, 894, 917, 936, 970, 982, 1014, 1045, 1073, 1109, 1146, 1196, 1236, 1264, 1315, 1355, 1412, 1446, 1474, 1507, 1554, 1588, 1631, 1666, 1739, 1793, 1858, 1905, 1963, 2003, 2053, 2121, 2197, 2272, 2332, 2388, 2467, 2537, 2595, 2660, 2751, 2817, 2895, 2954, 3036, 3114, 3194, 3268, 3369, 3481, 3575, 3661, 3771, 3855, 3966, 4060, 4173, 4268, 4375, 4524, 4641, 4782, 4944, 5086, 5247, 5375, 5547, 5715, 5858, 6030, 6135, 6299, 6477, 6651, 6827, 6988, 7148, 7328, 7488, 7635, 7799, 8003, 8200, 8385, 8609, 8785, 8956, 9152, 9348, 9545, 9771, 9944, 10179, 10423, 10657, 10879, 11142, 11323, 11554, 11776, 12008, 12207, 12455, 12695, 12930, 13156, 13435, 13662, 13890, 14156, 14402, 14637, 14888, 15118, 15384, 15618, 15851, 16122, 16324, 16554, 16742, 17014, 17244, 17445, 17666, 17883, 18122, 18280, 18507, 18697, 18899, 19162, 19392, 19609, 19786, 19951, 20119, 20310, 20459, 20633, 20804, 20999, 21152, 21299, 21497, 21669, 21805, 21930, 22068, 22210, 22314, 22440, 22520, 22624, 22697, 22881, 22951, 23009, 23082, 23217, 23203, 23246, 23313, 23385, 23426, 23531, 23530, 23577, 23554, 23570, 23580, 23636, 23629, 23639, 23615, 23607, 23615, 23604, 23531, 23486, 23437, 23394, 23292, 23231, 23196, 23129, 22998, 22917, 22832, 22771, 22680, 22571, 22457, 22366, 22282, 22133, 22026, 21919, 21849, 21697, 21554, 21442, 21294, 21209, 21086, 20963, 20819, 20673, 20547, 20458, 20299, 20102, 20007, 19870, 19714, 19521, 19352, 19187, 19034, 18856, 18691, 18601, 18408, 18246, 18097, 17940, 17794, 17665, 17499, 17335, 17197, 17039, 16876, 16710, 16578, 16406, 16253, 16061, 15874, 15710, 15557, 15377, 15239, 15071, 14904, 14796, 14639, 14489, 14339, 14208, 14051, 13902, 13795, 13638, 13493, 13337, 13214, 13038, 12895, 12779, 12651, 12493, 12361, 12201, 12089, 11957, 11821, 11675, 11545, 11382, 11251, 11090, 10979, 10835, 10703, 10546, 10428, 10285, 10166, 10035, 9909, 9785, 9661, 9547, 9429, 9281, 0, 4, 4, 5, 7, 7, 7, 7, 7, 7, 8, 8, 9, 9, 10, 11, 14, 16, 19, 20, 20, 21, 21, 23, 25, 25, 26, 26, 27, 27, 28, 30, 31, 32, 35, 36, 36, 36, 39, 40, 44, 44, 44, 45, 48, 50, 50, 52, 53, 56, 59, 60, 62, 63, 66, 69, 75, 82, 83, 88, 92, 96, 98, 101, 107, 110, 116, 116, 120, 129, 136, 146, 150, 159, 164, 168, 176, 185, 190, 195, 200, 206, 209, 215, 227, 236, 245, 253, 262, 271, 280, 291, 297, 310, 321, 334, 347, 354, 361, 372, 382, 387, 401, 416, 426, 433, 445, 453, 467, 485, 498, 517, 533, 556, 564, 576, 590, 609, 621, 651, 672, 693, 712, 722, 740, 767, 794, 818, 837, 863, 882, 912, 942, 972, 995, 1026, 1058, 1095, 1121, 1156, 1188, 1227, 1260, 1296, 1336, 1378, 1422, 1468, 1510, 1561, 1609, 1657, 1707, 1761, 1806, 1862, 1927, 1992, 2043, 2105, 2174, 2249, 2302, 2365, 2428, 2502, 2567, 2656, 2738, 2827, 2912, 3003, 3084, 3166, 3264, 3346, 3426, 3527, 3615, 3717, 3818, 3929, 4046, 4156, 4297, 4398, 4529, 4660, 4778, 4917, 5048, 5190, 5345, 5494, 5648, 5789, 5935, 6091, 6268, 6445, 6622, 6790, 6969, 7166, 7350, 7559, 7750, 7948, 8148, 8367, 8561, 8799, 9029, 9253, 9473, 9737, 9992, 10245, 10514, 10794, 11068, 11352, 11625, 11908, 12195, 12473, 12766, 13054, 13365, 13660, 14004, 14301, 14618, 14928, 15275, 15586, 15941, 16319, 16650, 16993, 17359, 17749, 18118, 18502, 18861, 19207, 19578, 19952, 20381, 20796, 21174, 21588, 22001, 22378, 22787, 23193, 23611, 24042, 24460, 24882, 25287, 25738, 26180, 26618, 27053, 27505, 27949, 28435, 28892, 29285, 29794, 30269, 30717, 31150, 31640, 32087, 32561, 32999, 33452, 33888, 34387, 34853, 35313, 35797, 36268, 36718, 37178, 37666, 38140, 38628, 39076, 39526, 40020, 40509, 40989, 41421, 41917, 42370, 42818, 43300, 43802, 44262, 44748, 45192, 45662, 46072, 46538, 46995, 47429, 47887, 48315, 48737, 49149, 49587, 50065, 50493, 50917, 51298, 51709, 52129, 52537, 52949, 53353, 53738, 54147, 54568, 54939, 55331, 55755, 56182, 56562, 56960, 57371, 57775, 58164, 58502, 58899, 59272, 59632, 59977, 60362, 60709, 61052, 61415, 61738, 62077, 62425, 62756, 63078, 63410, 63724, 64063, 64410, 64733, 65024, 65364, 65642, 65933, 66221, 66475, 66766, 67052, 67354, 67631, 67909, 68200, 68443, 68725, 68987, 69247, 69497, 69779, 70048, 70279, 70511, 70767, 71011, 71270, 71488, 71723, 71959, 72195, 72424, 72663, 72897, 73137, 73338, 73565, 73783, 74007, 74215, 74444, 74639, 74841, 75046, 75251, 75447, 75640, 75829, 76035]
params_res = posterior.sample((n_samples,), x=S_ref)

# sns.pairplot(pd.DataFrame(params_res.numpy()))
sns.displot(data=pd.DataFrame(params_res[:, 0].numpy()), kde=True, legend = False)
dirname = os.path.dirname(__file__)
filename = os.path.join(dirname, "beta_distribution.pdf")
plt.xlabel("β")
plt.savefig(filename, format="pdf", bbox_inches="tight")
sns.displot(data=pd.DataFrame(params_res[:, 1].numpy()), kde=True, legend = False)
dirname = os.path.dirname(__file__)
filename = os.path.join(dirname, "c_distribution.pdf")
plt.xlabel("c")
plt.savefig(filename, format="pdf", bbox_inches="tight")
sns.displot(data=pd.DataFrame(params_res[:, 2].numpy()), kde=True, legend = False)
dirname = os.path.dirname(__file__)
filename = os.path.join(dirname, "gamma_distribution.pdf")
plt.xlabel("γ")
plt.savefig(filename, format="pdf", bbox_inches="tight")
sns.displot(data=pd.DataFrame(params_res[:, 3].numpy()), kde=True, legend = False)
dirname = os.path.dirname(__file__)
filename = os.path.join(dirname, "I0_distribution.pdf")
plt.xlabel("I0")
plt.savefig(filename, format="pdf", bbox_inches="tight")

# dirname = os.path.dirname(__file__)
# filename = os.path.join(dirname, "parameters_distribution.png")
# plt.savefig(filename)

# # β_parameter = 0.09994323551654816
# # c_parameter = 15.053855895996094
# # γ_parameter = 0.028546009212732315
# # I0_parameter = 26.37752914428711

print(f'β_parameter = {torch.mean(params_res[:, 0])}')
print(f'c_parameter = {torch.mean(params_res[:, 1])}')
print(f'γ_parameter = {torch.mean(params_res[:, 2])}')
print(f'I0_parameter = {torch.mean(params_res[:, 3])}')
